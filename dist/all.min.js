"use strict";function _classCallCheck(n,o){if(!(n instanceof o))throw new TypeError("Cannot call a class as a function")}!function(){angular.module("cn.ui",["angularFileUpload","toaster","ngAnimate"])}(),function(){angular.module("cn.ui").directive("checkbox",function(){return{restrict:"C",link:function(n,o){"INPUT"===o.prop("tagName")?o.after("<span></span>"):o.find("input[type=checkbox]").after("<span></span>")}}})}(),function(){angular.module("cn.ui").directive("countrySelect",function(){return{restrict:"E",template:'<label for="{{id || \'country\'}}">Country</label>                     <select id="{{id || \'country\'}}" ng-model="ngModel" class="form-control">                       <option value="US">United States</option>                       <option value="AF">Afghanistan</option>                       <option value="AL">Albania</option>                       <option value="DZ">Algeria</option>                       <option value="AS">American Samoa</option>                       <option value="AD">Andorra</option>                       <option value="AO">Angola</option>                       <option value="AI">Anguilla</option>                       <option value="AQ">Antarctica</option>                       <option value="AG">Antigua And Barbuda</option>                       <option value="AR">Argentina</option>                       <option value="AM">Armenia</option>                       <option value="AW">Aruba</option>                       <option value="AU">Australia</option>                       <option value="AT">Austria</option>                       <option value="AZ">Azerbaijan</option>                       <option value="BS">Bahamas</option>                       <option value="BH">Bahrain</option>                       <option value="BD">Bangladesh</option>                       <option value="BB">Barbados</option>                       <option value="BY">Belarus</option>                       <option value="BE">Belgium</option>                       <option value="BZ">Belize</option>                       <option value="BJ">Benin</option>                       <option value="BM">Bermuda</option>                       <option value="BT">Bhutan</option>                       <option value="BO">Bolivia</option>                       <option value="BA">Bosnia And Herzegovina</option>                       <option value="BW">Botswana</option>                       <option value="BV">Bouvet Island</option>                       <option value="BR">Brazil</option>                       <option value="IO">British Indian Ocean Territory</option>                       <option value="BN">Brunei Darussalam</option>                       <option value="BG">Bulgaria</option>                       <option value="BF">Burkina Faso</option>                       <option value="BI">Burundi</option>                       <option value="KH">Cambodia</option>                       <option value="CM">Cameroon</option>                       <option value="CA">Canada</option>                       <option value="CV">Cape Verde</option>                       <option value="KY">Cayman Islands</option>                       <option value="CF">Central African Republic</option>                       <option value="TD">Chad</option>                       <option value="CL">Chile</option>                       <option value="CN">China</option>                       <option value="CX">Christmas Island</option>                       <option value="CC">Cocos (keeling) Islands</option>                       <option value="CO">Colombia</option>                       <option value="KM">Comoros</option>                       <option value="CG">Congo</option>                       <option value="CK">Cook Islands</option>                       <option value="CR">Costa Rica</option>                       <option value="CI">Cote D Ivoire</option>                       <option value="HR">Croatia</option>                       <option value="CU">Cuba</option>                       <option value="CY">Cyprus</option>                       <option value="CZ">Czech Republic</option>                       <option value="DK">Denmark</option>                       <option value="DJ">Djibouti</option>                       <option value="DM">Dominica</option>                       <option value="DO">Dominican Republic</option>                       <option value="TP">East Timor</option>                       <option value="EC">Ecuador</option>                       <option value="EG">Egypt</option>                       <option value="SV">El Salvador</option>                       <option value="GQ">Equatorial Guinea</option>                       <option value="ER">Eritrea</option>                       <option value="EE">Estonia</option>                       <option value="ET">Ethiopia</option>                       <option value="FK">Falkland Islands (malvinas)</option>                       <option value="FO">Faroe Islands</option>                       <option value="FJ">Fiji</option>                       <option value="FI">Finland</option>                       <option value="FR">France</option>                       <option value="GF">French Guiana</option>                       <option value="PF">French Polynesia</option>                       <option value="TF">French Southern Territories</option>                       <option value="GA">Gabon</option>                       <option value="GM">Gambia</option>                       <option value="GE">Georgia</option>                       <option value="DE">Germany</option>                       <option value="GH">Ghana</option>                       <option value="GI">Gibraltar</option>                       <option value="GR">Greece</option>                       <option value="GL">Greenland</option>                       <option value="GD">Grenada</option>                       <option value="GP">Guadeloupe</option>                       <option value="GU">Guam</option>                       <option value="GT">Guatemala</option>                       <option value="GN">Guinea</option>                       <option value="GW">Guinea-bissau</option>                       <option value="GY">Guyana</option>                       <option value="HT">Haiti</option>                       <option value="VA">Holy See (vatican City State)</option>                       <option value="HN">Honduras</option>                       <option value="HK">Hong Kong</option>                       <option value="HU">Hungary</option>                       <option value="IS">Iceland</option>                       <option value="IN">India</option>                       <option value="ID">Indonesia</option>                       <option value="IR">Iran, Islamic Republic Of</option>                       <option value="IQ">Iraq</option>                       <option value="IE">Ireland</option>                       <option value="IL">Israel</option>                       <option value="IT">Italy</option>                       <option value="JM">Jamaica</option>                       <option value="JP">Japan</option>                       <option value="JO">Jordan</option>                       <option value="KZ">Kazakstan</option>                       <option value="KE">Kenya</option>                       <option value="KI">Kiribati</option>                       <option value="KP">Korea Democratic Peoples Republic Of</option>                       <option value="KR">Korea Republic Of</option>                       <option value="KW">Kuwait</option>                       <option value="KG">Kyrgyzstan</option>                       <option value="LA">Lao Peoples Democratic Republic</option>                       <option value="LV">Latvia</option>                       <option value="LB">Lebanon</option>                       <option value="LS">Lesotho</option>                       <option value="LR">Liberia</option>                       <option value="LY">Libyan Arab Jamahiriya</option>                       <option value="LI">Liechtenstein</option>                       <option value="LT">Lithuania</option>                       <option value="LU">Luxembourg</option>                       <option value="MO">Macau</option>                       <option value="MK">Macedonia</option>                       <option value="MG">Madagascar</option>                       <option value="MW">Malawi</option>                       <option value="MY">Malaysia</option>                       <option value="MV">Maldives</option>                       <option value="ML">Mali</option>                       <option value="MT">Malta</option>                       <option value="MH">Marshall Islands</option>                       <option value="MQ">Martinique</option>                       <option value="MR">Mauritania</option>                       <option value="MU">Mauritius</option>                       <option value="YT">Mayotte</option>                       <option value="MX">Mexico</option>                       <option value="FM">Micronesia, Federated States Of</option>                       <option value="MD">Moldova, Republic Of</option>                       <option value="MC">Monaco</option>                       <option value="MN">Mongolia</option>                       <option value="MS">Montserrat</option>                       <option value="MA">Morocco</option>                       <option value="MZ">Mozambique</option>                       <option value="MM">Myanmar</option>                       <option value="NA">Namibia</option>                       <option value="NR">Nauru</option>                       <option value="NP">Nepal</option>                       <option value="NL">Netherlands</option>                       <option value="AN">Netherlands Antilles</option>                       <option value="NC">New Caledonia</option>                       <option value="NZ">New Zealand</option>                       <option value="NI">Nicaragua</option>                       <option value="NE">Niger</option>                       <option value="NG">Nigeria</option>                       <option value="NU">Niue</option>                       <option value="NF">Norfolk Island</option>                       <option value="MP">Northern Mariana Islands</option>                       <option value="NO">Norway</option>                       <option value="OM">Oman</option>                       <option value="PK">Pakistan</option>                       <option value="PW">Palau</option>                       <option value="PS">Palestinian Territory, Occupied</option>                       <option value="PA">Panama</option>                       <option value="PG">Papua New Guinea</option>                       <option value="PY">Paraguay</option>                       <option value="PE">Peru</option>                       <option value="PH">Philippines</option>                       <option value="PN">Pitcairn</option>                       <option value="PL">Poland</option>                       <option value="PT">Portugal</option>                       <option value="PR">Puerto Rico</option>                       <option value="QA">Qatar</option>                       <option value="RE">Reunion</option>                       <option value="RO">Romania</option>                       <option value="RU">Russian Federation</option>                       <option value="RW">Rwanda</option>                       <option value="SH">Saint Helena</option>                       <option value="KN">Saint Kitts And Nevis</option>                       <option value="LC">Saint Lucia</option>                       <option value="PM">Saint Pierre And Miquelon</option>                       <option value="VC">Saint Vincent And The Grenadines</option>                       <option value="WS">Samoa</option>                       <option value="SM">San Marino</option>                       <option value="ST">Sao Tome And Principe</option>                       <option value="SA">Saudi Arabia</option>                       <option value="SN">Senegal</option>                       <option value="SC">Seychelles</option>                       <option value="SL">Sierra Leone</option>                       <option value="SG">Singapore</option>                       <option value="SK">Slovakia</option>                       <option value="SI">Slovenia</option>                       <option value="SB">Solomon Islands</option>                       <option value="SO">Somalia</option>                       <option value="ZA">South Africa</option>                       <option value="GS">South Georgia</option>                       <option value="ES">Spain</option>                       <option value="LK">Sri Lanka</option>                       <option value="SD">Sudan</option>                       <option value="SR">Suriname</option>                       <option value="SJ">Svalbard And Jan Mayen</option>                       <option value="SZ">Swaziland</option>                       <option value="SE">Sweden</option>                       <option value="CH">Switzerland</option>                       <option value="SY">Syrian Arab Republic</option>                       <option value="TW">Taiwan, Province Of China</option>                       <option value="TJ">Tajikistan</option>                       <option value="TZ">Tanzania, United Republic Of</option>                       <option value="TH">Thailand</option>                       <option value="TG">Togo</option>                       <option value="TK">Tokelau</option>                       <option value="TO">Tonga</option>                       <option value="TT">Trinidad And Tobago</option>                       <option value="TN">Tunisia</option>                       <option value="TR">Turkey</option>                       <option value="TM">Turkmenistan</option>                       <option value="TC">Turks And Caicos Islands</option>                       <option value="TV">Tuvalu</option>                       <option value="UG">Uganda</option>                       <option value="UA">Ukraine</option>                       <option value="AE">United Arab Emirates</option>                       <option value="GB">United Kingdom</option>                       <option value="UM">United States Minor Outlying Islands</option>                       <option value="UY">Uruguay</option>                       <option value="UZ">Uzbekistan</option>                       <option value="VU">Vanuatu</option>                       <option value="VE">Venezuela</option>                       <option value="VN">Viet Nam</option>                       <option value="VG">Virgin Islands, British</option>                       <option value="VI">Virgin Islands, U.s.</option>                       <option value="WF">Wallis And Futuna</option>                       <option value="EH">Western Sahara</option>                       <option value="YE">Yemen</option>                       <option value="YU">Yugoslavia</option>                       <option value="ZM">Zambia</option>                       <option value="ZW">Zimbabwe</option>                     </select>',scope:{id:"&?",ngModel:"="}}})}(),function(){function n(){return{restrict:"E",scope:{cnUploadPath:"=",ngModel:"="},link:o,controller:t,controllerAs:"vm",bindToController:!0,template:'        <file-upload class="col-sm-6"                     btn-text="Upload CSV"                     accept=".csv"                     on-file-select="vm.uploadFile($files)">        </file-upload>      '}}function o(n,o,t,e){n.$watch("vm.ngModel",function(o,t){n.onChange&&n.onChange({$value:o}),n.$parent.$parent.ngModel&&n.$parent.$parent.ngModel.$setValidity("schemaForm",!0),n.$parent.$parent.form.required&&n.$parent.$parent.ngModel.$setValidity("tv4-302",!_.isEmpty(n.vm.ngModel)),angular.equals(o,t)||n.$parent.$parent.ngModel.$setDirty()})}function t(n,o,t,e,i,a){function l(t){var i=n.defer();i.promise.then(s,r);var a=new FormData;a.append("csv",t[0]),$.ajax({url:p.cnUploadPath,headers:o.defaults.headers.common,data:a,processData:!1,contentType:!1,type:"POST",success:i.resolve,error:i.reject}),e.start()}function s(n){e.complete(),p.ngModel=n}function r(n){var o=JSON.parse(n.responseText);i.$broadcast(a.httpError,{status:o.status,errors:[{data:o.error}]}),e.complete()}var p=this;p.uploadFile=l}angular.module("cn.ui").directive("csvUpload",n),t.$inject=["$q","$http","$sce","cfpLoadingBar","$rootScope","EVENTS"]}(),function(){function n(n){function o(n,o,t,e){function i(){r&&(r=l(r),o.attr("placeholder",r)),o.on("blur",function(n){if(/\.\d$/.test(o[0].value))return o[0].value+="0";var t=o[0].value.match(/(\d*\.\d{2})(.+)/);t&&(o[0].value=t[1])}),e.$parsers.unshift(a),e.$formatters.unshift(function(n){return e.$setDirty(),l(n)})}function a(n){return n?"cents"===s?_.multiply(n,100):"microcents"===s?_.multiply(n,1e6):parseFloat(n):n}function l(n){return n=n?"cents"===s?_.floor(n/100,2)||"":"microcents"===s?_.floor(n/1e6,2)||"":_.floor(n,2)||"":"",/\.\d$/.test(n)?n+"0":n}if(e){var s=t.cnCurrencyFormat,r=t.cnCurrencyPlaceholder;i()}}return{require:"?ngModel",link:o}}angular.module("cn.ui").directive("cnCurrencyFormat",n),n.$inject=["$compile"]}(),function(){angular.module("cn.ui").directive("fileUpload",function(){return{restrict:"E",replace:!0,scope:{btnStyle:"@",iconStyle:"@",callback:"&onFileSelect",inputId:"@",btnText:"@",accept:"@"},template:'<div class="file-wrapper">                       <button class="btn btn-file {{btnStyle}}">                         <i ng-if="iconStyle" class="{{iconStyle}}"></i> {{btnText}}                       </button>                       <input type="file" id="{{inputId}}" class="form-control" accept="{{accept}}"                              ng-file-select="onFileSelect($files)"/>                     </div>',compile:function(n,o){return o.btnStyle=/btn-(primary|success|info|warning|danger|link)/.test(o.btnStyle)?o.btnStyle:o.btnStyle+" btn-default",o.inputId=o.inputId||"file-"+_.uniqueId(),o.btnText=o.btnText||"Choose a file...",function(n,o){var t=o.find("button"),e=o.find("input");t.click(function(){e.click()}),n.onFileSelect=function(o){n.callback({$files:o})}}}}})}(),function(){function n(){return{restrict:"E",template:'\n        <div class="cn-heading cn-mast-head">\n          <div class="cn-mast-head-inner">\n            <div class="cn-mast-head-main">\n              <div class="cn-heading-title">\n                <a ng-if="vm.config.backState"\n                   class="cn-heading-back"\n                   ui-sref="{{vm.config.backState}}">\n                  <i ng-show="vm.config.backState" class="icn-back"></i>\n                </a>\n                <h1 ng-hide="vm.config.dropdown">\n                  {{vm.config.title}}\n                </h1>\n                <h1 ng-show="vm.config.dropdown" data-toggle="dropdown">\n                  <a>\n                    {{vm.config.title}}\n                    <i ng-show="vm.config.dropdown" class="icn-caret"></i>\n                  </a>\n                </h1>\n                <ul ng-if="vm.config.dropdown"\n                    class="dropdown-menu row"\n                    ng-class="vm.config.dropdown.style"\n                    style="width: {{vm.config.dropdown.lists.length * 250}}px"\n                    role="menu">\n                  <div ng-repeat="list in vm.config.dropdown.lists"\n                       style="width: 250px">\n                    <li class="{{list.style}}">\n                      <div class="input-group">\n                        <input ng-model="list.filter"\n                               class="form-control"\n                               placeholder="{{list.name}}"/>\n                        <span class="input-group-addon">\n                          <i class="icn-search"></i>\n                        </span>\n                      </div>\n                    </li>\n                    <li class="divider"></li>\n                    <li ng-repeat="item in list.items | filter:list.filter"\n                        class="{{list.style}} {{item.style}}">\n                      <a ng-show="item.name"\n                         ng-click="list.handler(item)"\n                         ng-class="{\'selected\': list.isSelected(item)}">{{item.name}}</a>\n                    </li>\n                  </div>\n                </ul>\n              </div>\n  \n              <div ng-show="vm.config.options"\n                   class="pull-right btn-options">\n                <span ng-repeat="btn in vm.config.options">\n                  <a ng-if="btn.state"\n                     class="btn btn-sm btn-transparent"\n                     ui-sref="{{btn.state}}"\n                     title="{{btn.title}}">\n                    <i class="{{btn.icon}}"/>\n                  </a>\n                  <a ng-if="btn.href"\n                     class="btn btn-sm btn-transparent"\n                     ng-href="{{btn.href}}"\n                     title="{{btn.title}}">\n                    <i class="{{btn.icon}}"/>\n                  </a>\n                </span>\n              </div>\n            </div>\n          </div>\n          <div class="cn-mast-head-sub">\n            <div class="cn-mast-head-inner">\n              <ul class="tabs" ng-if="vm.config.tabs && vm.config.tabs.length">\n                <li ng-repeat="tab in vm.config.tabs"\n                    ng-class="{active: tab.active}"\n                    class="{{tab.style}}">\n                  <a ng-if="tab.state"\n                     ui-sref="{{tab.state}}">\n                    <i ng-show="tab.active" class="{{tab.icon}}"/>\n                    {{tab.name}}\n                  </a>\n                  <span ng-if="!tab.state">\n                    {{tab.name}}\n                  </span>\n                </li>\n              </ul>\n            </div>\n          </div>\n          <div class="cn-mast-actions">\n            <div class="cn-mast-head-inner">\n              <div class="cn-actions"\n                   ng-if="vm.floater"\n                   ng-mouseenter="vm.toggleFloaters(false)"\n                   ng-mouseleave="vm.toggleFloaters(true)">\n                <floating-action-button\n                  ng-mouseenter="vm.floater.showTitle = true"\n                  ng-mouseleave="vm.floater.showTitle = false">\n                  <a class="btn {{vm.hideFloaters ? \'\' : vm.floater.style}}"\n                     ui-sref="{{vm.floater.state}}">\n                     <i ng-show="vm.floater.icon && !vm.hideFloaters"\n                        class="{{vm.floater.icon}}"></i>\n                     <span ng-show="vm.floater.text && vm.hideFloaters" class="text">\n                       {{vm.floater.text}}\n                     </span>\n                     <span ng-hide="vm.floater.icon || vm.floater.text || vm.hideFloaters">\n                       {{vm.floater.symbol || \'+\'}}\n                     </span>\n                     <span ng-show="vm.hideFloaters">+</span>\n                  </a>\n                  <span class="fab-title"\n                        ng-show="vm.floater.showTitle && vm.floater.title">\n                    {{vm.floater.title}}\n                  </span>\n                </floating-action-button>\n                <div class="cn-floaters" style="height: {{vm.floatersHeight}}">\n                  <div class="cn-floaters-inner">\n                    <floating-action-button\n                      ng-repeat="btn in vm.floaters"\n                      ng-mouseenter="btn.showTitle = true"\n                      ng-mouseleave="btn.showTitle = false">\n                      <a ng-show="btn.state"\n                         class="btn {{btn.style}}"\n                         ui-sref="{{btn.state}}">\n                         <i ng-show="btn.icon" class="{{btn.icon}}"></i>\n                         <span ng-show="btn.text" class="text">{{btn.text}}</span>\n                         <span ng-show="btn.symbol">{{btn.symbol}}</span>\n                       </a>\n                      <span class="fab-title"\n                            ng-show="btn.showTitle && btn.title">\n                        {{btn.title}}\n                      </span>\n                    </floating-action-button>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>',scope:{config:"="},link:function(n,o){console.log("scope:",n),n.vm.elem=o},controller:o,controllerAs:"vm",bindToController:!0}}function o(){function n(n){o.floatersHeight=n?0:o.elem.find(".cn-floaters-inner").outerHeight()+"px",o.hideFloaters=n}var o=this;o.floater=_.first(o.config.actions),o.floaters=_.rest(o.config.actions),o.floatersHeight=0,o.hideFloaters=!0,o.toggleFloaters=n,console.log("vm:",o)}angular.module("cn.ui").directive("cnMastHead",n)}(),function(){function n(n){function o(o,t,e){function i(){return(l=a())?(t.height(""),s=l.scrollHeight,t.height(s),angular.element(l).find("img").on("load",i),void(r||(++r,n(i,200),n(i,500),n(i,1e3),n(i,1500),n(i,3500),n(i,5e3),n(i,7500),n(i,1e4)))):void n(i,100)}function a(){return t.get(0).contentDocument&&t.get(0).contentDocument.body}var l,s,r;o.$watch(function(){return e.ngSrc},function(){e.ngSrc&&(r=0,n(i,100))})}return{restrict:"A",link:o}}angular.module("cn.ui").directive("cnIframeHeight",n),n.$inject=["$timeout"]}(),function(){angular.module("cn.ui").directive("linkToFacebook",function(){var n="https://www.facebook.com/ads/manage/summary/";return{restrict:"E",replace:!0,template:'<a href="{{ link }}" target="_blank" ng-show="link" ng-click="$event.stopPropagation();">                       {{text}}                       <span class="glyphicon glyphicon-new-window small"></span>                     </a>',scope:{fbObject:"=",text:"@?"},link:function(o){o.fbObject.twitterLink?o.link=o.fbObject.twitterLink:_.has(o.fbObject,"fbCampaignGroupId")?o.fbObject.fbCampaignGroupId&&(o.link=n+"campaign/?campaign_id="+o.fbObject.fbCampaignGroupId):_.has(o.fbObject,"fbCampaignId")?o.fbObject.fbCampaignId&&(o.link=n+"adset/?ad_set_id="+o.fbObject.fbCampaignId):_.has(o.fbObject,"fbAdgroupId")&&o.fbObject.adSet.fbCampaignId&&o.fbObject.fbAdgroupId&&(o.link=n+"adset/?ad_set_id="+o.fbObject.adSet.fbCampaignId+"&show_adgroup_id="+o.fbObject.fbAdgroupId)}}})}(),function(){angular.module("cn.ui").directive("cnLoadingBar",function(){return{restrict:"E",replace:!0,scope:{run:"="},template:'<div><cn-progress-bar cn-limit="1" cn-progress="progress"></cn-progress-bar></div>',controller:["$scope","$interval",function(n,o){function t(){n.interval=o(function(){n.progress=n.progress+n.numerator/n.denominator,n.denominator=n.denominator+2/n.counter,n.counter=.66*n.counter},500)}function e(){console.log("stop:",n.interval),o.cancel(n.interval),n.progress=100}n.progress=0,n.counter=1,n.numerator=1,n.denominator=3,n.$watch("run",function(o,i){console.log("run:",n.run),o!==i&&(n.run?t():e())}),n.$on("$destroy",function(){e()})}]}})}(),function(){function n(){return{restrict:"E",scope:{cnUploadPath:"=",cnFileType:"=",cnPreviewPath:"=",cnModelValueKey:"=",ngModel:"=",cnData:"="},controller:o,controllerAs:"vm",bindToController:!0,template:'        <div class="img-placeholder col-sm-6" ng-class="{ empty: !vm.filePath }">          <img ng-if="vm.cnFileType === \'image\'" ng-src="{{vm.filePath}}"/>          <video ng-if="vm.cnFileType === \'video\' && vm.filePath"                 ng-src="{{vm.filePath}}"                 controls="controls"/>        </div>        <file-upload class="col-sm-6"                     btn-text="Upload {{vm.cnFileType | titleCase}}"                     on-file-select="vm.uploadFile($files)">        </file-upload>      '}}function o(n,o,t,e){function i(){"image"===s.cnFileType&&s.ngModel?s.filePath=t.trustAsResourceUrl(s.ngModel):"video"===s.cnFileType&&s.ngModel&&(s.filePath=t.trustAsResourceUrl(s.ngModel.media))}function a(t){var i=n.defer();i.promise.then(l,e.complete);var a=new FormData;a.append(s.cnFileType,t[0]),_.each(s.cnData,function(n,o){n&&a.append(o,n)}),$.ajax({url:s.cnUploadPath,headers:o.defaults.headers.common,data:a,processData:!1,contentType:!1,type:"POST",success:i.resolve,error:i.reject}),e.start()}function l(n){e.complete(),s.ngModel=n[s.cnModelValueKey||"media_id_string"],s.filePath=t.trustAsResourceUrl(n[s.cnPreviewPath||"cn_preview_url"])}var s=this;s.uploadFile=a,i()}angular.module("cn.ui").directive("mediaUpload",n),o.$inject=["$q","$http","$sce","cfpLoadingBar"]}(),function(){function n(n,o){function t(t){return e.onChangeState=o.$on("$stateChangeStart",function(){console.log("changeState:",e.modal),e.onChangeState(),e.modal&&e.modal.close()}),e.modal=n.open(t),e.modal}var e={onChangeState:null,open:t};return e}angular.module("cn.ui").factory("cnModal",n),n.$inject=["$modal","$rootScope"]}(),function(){function n(n){"$inject";return{restrict:"A",link:function(o,t,e){var i=n(e.cnOnerror);t[0].onerror=function(n,t){return i(o,{param:t})}}}}n.$inject=["$parse"],angular.module("cn.ui").directive("cnOnerror",n)}(),function(){function n(){return{restrict:"E",replace:!0,template:'          <div class="cn-pagination clearfix"><div ng-if="paging">            <div class="btn-group" ng-if="count">              <button type="button"                       class="btn btn-sm btn-primary dropdown-toggle"                       data-toggle="dropdown">                {{count}} Results <span class="caret"></span>              </button>              <ul class="dropdown-menu" role="menu">                <li><a ng-click="onClick(1, 10)">10 Results</a></li>                <li><a ng-click="onClick(1, 25)">25 Results</a></li>                <li><a ng-click="onClick(1, 50)">50 Results</a></li>              </ul>            </div>            <ul class="pagination" ng-if="pages.length > 1">              <li ng-repeat="page in pages"                  ng-class="{active: page.active}">                <a ng-if="!page.disabled"                   ng-click="page.skip && onClick(page.skip)">{{page.label}}</a>                <span ng-if="page.disabled">{{page.label}}</span>              </li>            </ul>          </div></div>',scope:{paging:"=",onClick:"=",count:"=?"},link:function(n){function o(n){var o=[],t=n.skip<4?1:n.skip>n.last-3?n.last-4:n.skip-2,e=n.last+1>t+5?t+5:n.last+1;for(1!==n.skip&&o.push({label:"←",skip:n.skip-1}),t>1&&(o.push({label:1,skip:1}),o.push({label:"...",disabled:!0}));e>t;t++)o.push({label:t,active:t===n.skip,skip:t});return n.last>=e&&(o.push({label:"...",disabled:!0}),o.push({label:n.last,skip:n.last})),n.skip!==n.last&&o.push({label:"→",skip:n.skip+1}),o}n.$watch("paging",function(){n.paging&&(n.pages=o(n.paging))})}}}angular.module("cn.ui").directive("cnPagination",n)}(),function(){function n(n,o){function t(t,e){function i(){e.width(l.width())}var a=angular.element(n),l=e.parent();a.bind("resize",i),i(),o(i,250)}return{restrict:"A",link:t}}angular.module("cn.ui").directive("cnParentWidth",n),n.$inject=["$window","$timeout"]}(),function(){function n(){function n(n,o,t,e){e&&(e.$parsers.unshift(function(){return _.divide(o[0].value,100)}),e.$formatters.unshift(function(){return o[0].value=100*e.$modelValue,o[0].value}))}return{require:"?ngModel",link:n}}angular.module("cn.ui").directive("cnPercentageFormat",n)}(),function(){angular.module("cn.ui").directive("cnProgressBar",function(){return{restrict:"E",replace:!0,scope:{limit:"=cnLimit",projected:"=cnProjected",progress:"=cnProgress",flexWidth:"=cnProgressBarFlexWidth"},template:'<div class="cn-progress-container {{flexWidth ? \'flex-width\' : \'\'}}">                       <div class="cn-projected-bar"                             ng-class="{\'cn-progress-over\': limit && projected > limit}">                         <div class="cn-progress-bar"                               ng-class="{\'cn-progress-over\': limit && progress > limit}"></div>                       </div>                     </div>',
link:function(n,o){function t(n,o){return(o?_.percentage(n,o):100)+"%"}var e=o.find(".cn-projected-bar"),i=o.find(".cn-progress-bar");n.$watch(function(){return""+n.limit+n.projected+n.progress},function(){e.css("width",t(n.projected||n.progress,n.limit)),i.css("width",t(n.progress,n.projected))})}}})}(),function(){angular.module("cn.ui").directive("radio",function(){return{restrict:"C",link:function(n,o){"INPUT"===o.prop("tagName")?o.after("<span></span>"):o.find("input[type=radio]").after("<span></span>")}}})}(),function(){function n(n,o){function t(t,e,i){function a(){if(n.innerWidth>s){var t=e.offset().top;if(0>t)o(a,500);else{var r=i.cnResponsiveHeight||0,p=l.height()-t-r,c=i.cnResponsiveOverflow||"auto";p=p?p+"px":"auto",_.has(i,"cnSetMaxHeight")?e.css({"max-height":p,overflow:c}):e.css({height:p,overflow:c})}}else e.css({height:""})}var l=angular.element(n),s={sm:768,md:992,lg:1200}[i.cnResponsiveBreak]||0;l.bind("resize",a),o(a,250),o(a,500)}var e={restrict:"EA",link:t};return e}angular.module("cn.ui").directive("cnResponsiveHeight",n),n.$inject=["$window","$timeout"]}(),function(){function n(){return{restrict:"E",template:function(n,o){console.log("template:",n,o);var t='          <div class="cn-select-or" ng-disabled="vm.disabled">            <p ng-show="vm.selectFrom.length" class="toggle-view">              <a ng-click="vm.toggleView()">                {{vm.view === \'list\' ? vm.toggleText.list : vm.toggleText.new}}              </a>            </p>            <div ng-show="vm.form.view === \'new\'" ng-transclude/>            <div ng-show="vm.form.view === \'list\'" class="cn-list">              <table class="list-group table card-flex">                <tr ng-repeat="item in vm.selectFrom"                    selection-model                    selection-model-type="checkbox"                    selection-model-cleanup-strategy="deselect"                    selection-model-selected-items="vm.selected">                  <td class="col-sm-1 text-center">                    <span class="checkbox">                      <input type="checkbox" id="checkbox{{ item.id }}" selection-model-ignore="false"/>                    </span>                  </td>                  <td class="col-sm-11" ng-bind-html="vm.processTemplate(item)"></td>                </tr>              </table>            </div>          </div>        ';return console.log("tpl:",t),t},transclude:!0,scope:{selectFrom:"=",ngModel:"=",form:"=ffForm",directiveId:"=",toggleText:"=",disabled:"=",itemTemplate:"="},require:"ngModel",link:o,controller:t,controllerAs:"vm",bindToController:!0}}function o(n,o,t,e){function i(n,o){angular.equals(n,o)||(e.$setDirty(),a.form.required&&e.$setValidity("tv4-302",!!n))}var a=n.vm;n.$watch("vm.ngModel",i,!0)}function t(n,o,t){function e(){console.log("vm:",r),r.form.schema._required=_.clone(r.form.schema.required)}function i(n){return o.trustAsHtml(t(r.itemTemplate)(n))}function a(){console.log("onSelectionChange:",r.selected,r.ngModel),r.setValue(_.first(r.selected)||null)}function l(n){n&&(n="object"===r.form.schema.type?n:n[r.form.valueProperty||"value"]),r.ngModel=n}function s(){console.log("toggleView:",r.form.view,r.form),r.form.view="new"===r.form.view?"list":"new",r.selected[0]&&(r.selected[0].selected=!1,r.selected.length=0)}var r=this;r.selected=[],r.form.view=r.form.view||"new",r.activate=e,r.onSelectionChange=a,r.processTemplate=i,r.setValue=l,r.toggleView=s,n.$watch("vm.selected.length",r.onSelectionChange),r.activate()}angular.module("cn.ui").directive("cnSelectOr",n),t.$inject=["$scope","$sce","$interpolate"]}();var _createClass=function(){function n(n,o){for(var t=0;t<o.length;t++){var e=o[t];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(n,e.key,e)}}return function(o,t,e){return t&&n(o.prototype,t),e&&n(o,e),o}}();!function(){var n=function(){function n(o,t){"ngInject";_classCallCheck(this,n),console.log("constructor::::",o,this),this.$element=o,this.$timeout=t}return n.$inject=["$element","$timeout"],_createClass(n,[{key:"$onInit",value:function(){this.$element.addClass("animated fast animated-width"),this.toggleShow()}},{key:"$onChanges",value:function(n){console.log("changes:::",n,this.show),n.show&&this.toggleShow()}},{key:"toggleShow",value:function(){var n=this;this.show?this.$timeout(function(){n.$element.removeClass(n.hideClass).addClass(n.showClass)},this.showDelay||0):this.$timeout(function(){n.$element.removeClass(n.showClass).addClass(n.hideClass)},this.hideDelay||0)}}]),n}(),o={controller:n,controllerAs:"shelf",bindings:{show:"<",showClass:"@",hideClass:"@",showDelay:"<",hideDelay:"<"}};angular.module("cn.ui").component("cnShelf",o)}();var _extends=Object.assign||function(n){for(var o=1;o<arguments.length;o++){var t=arguments[o];for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(n[e]=t[e])}return n};!function(){function n(n,o){function t(n){switch(n){case"success":return"icn-thumbsup";case"warning":return"icn-error";case"danger":return"icn-error";case"error":return"icn-error";default:return"icn-info"}}var e={timeout:5e3,toasterId:"simple",body:"simple-toast",bodyOutputType:"directive",tapToDismiss:!1,closeHtml:"<a>Dismiss</a>"};n.$on("citizenNet:toastEvent",function(n,i){_.isObject(i)?(i.directiveData.icon=t(i.directiveData.type),o.pop(_extends({},e,i))):o.pop(_extends({},e,{directiveData:{body:i}}))})}n.$inject=["$rootScope","toaster"];var o=function(){return{template:"\n      <div class='flex-box align-items-center'>\n        <div class=\"padding-right-20\">\n          <i ng-class=\"directiveData.icon || 'icn-info'\"></i>\n        </div>\n        <div class=\"padding-right-20 flex-1\">\n          <span ng-bind-html='directiveData.body'>{{directiveData.body}}</span>\n        </div>\n      </div>\n    "}},t=function(){return{template:"\n      <div class='flex-box align-items-center'>\n        <div class='padding-right-20'>\n          <i ng-class='directiveData.icon || \"icn-info\"'></i>\n        </div>\n        <div class='padding-right-20 flex-1'>\n          <span>{{directiveData.body}}</span>\n        </div>\n        <div class='btn-group'>\n          <span ng-repeat='action in directiveData.actions'>\n            <a class='btn btn-primary' ng-click='action.click()'>{{action.text}}</a>\n          </span>\n        </div>\n      </div>\n    "}},e=function(){return{template:'\n      <div class="flex-box align-items-center">\n        <div class="padding-right-40">\n          <span class="label">{{directiveData.selected.length}}</span>\n          {{directiveData.type}} Selected\n        </div>\n        <div class="padding-right-20 flex-5 btn-group">\n          <span ng-repeat="action in directiveData.actions">\n            <a class="btn btn-default margin-right-10" ng-click="action.click()">{{action.text}}</a>\n          </span>\n        </div>\n        <div>\n          <a ng-click="directiveData.deselect()">Deselect All</a>\n        </div>\n      </div>\n    '}};angular.module("cn.ui").controller("toastController",n).directive("simpleToast",o).directive("actionToast",t).directive("listToast",e)}(),function(){angular.module("cn.ui").directive("cnToggleSwitch",function(){return{restrict:"E",replace:!0,template:'                  <div class="cn-toggle"                       ng-class="currentCssState()"                       ng-click="toggle($event)">                    <i class="icn-toggle"                       ng-class="currentCssState()"></i>                  </div>',require:"^ngModel",scope:{ngModel:"=",onValue:"=?",offValue:"=?",undefinedClass:"=?",readOnly:"=",onChange:"&"},link:function(n,o,t,e){n.onValue=_.isUndefined(n.onValue)?!0:n.onValue,n.offValue=_.isUndefined(n.offValue)?!1:n.offValue,n.undefinedClass=n.undefinedClass||"schrodinger",n.currentCssState=function(){var o=[];return n.readOnly&&o.push("readonly"),n.ngModel==n.onValue||(n.ngModel==n.offValue?o.push("disabled"):o.push(n.undefinedClass)),o.join(" ")},n.toggle=function(o){console.log("toggle:",n),o.preventDefault(),o.stopImmediatePropagation(),n.ngModel==n.onValue?n.ngModel=n.offValue:n.ngModel=n.onValue,e.$setDirty(),n.onChange&&n.onChange()}}}})}(),function(){angular.module("cn.ui").directive("truncate",function(){return{restrict:"AE",scope:{text:"=truncateText",size:"=truncateSize",show:"@truncateShow"},link:function(n,o){function t(){o.text(a?e:i),a=!a}var e=n.text||"",i=e.length>n.size?e.substr(0,n.size)+"…":e,a=!1;t(),n.show&&o.on(n.show,t)}}})}();
//# sourceMappingURL=cn-ui.min.js.map

/*! 1.4.0 */
!function(){var a=angular.module("angularFileUpload",[]);a.service("$upload",["$http","$timeout",function(a,b){function c(c){c.method=c.method||"POST",c.headers=c.headers||{},c.transformRequest=c.transformRequest||function(b,c){return window.ArrayBuffer&&b instanceof window.ArrayBuffer?b:a.defaults.transformRequest[0](b,c)},window.XMLHttpRequest.__isShim&&(c.headers.__setXHR_=function(){return function(a){a&&(c.__XHR=a,c.xhrFn&&c.xhrFn(a),a.upload.addEventListener("progress",function(a){c.progress&&b(function(){c.progress&&c.progress(a)})},!1),a.upload.addEventListener("load",function(a){a.lengthComputable&&c.progress&&c.progress(a)},!1))}});var d=a(c);return d.progress=function(a){return c.progress=a,d},d.abort=function(){return c.__XHR&&b(function(){c.__XHR.abort()}),d},d.xhr=function(a){return c.xhrFn=a,d},d.then=function(a,b){return function(d,e,f){c.progress=f||c.progress;var g=b.apply(a,[d,e,f]);return g.abort=a.abort,g.progress=a.progress,g.xhr=a.xhr,g.then=a.then,g}}(d,d.then),d}this.upload=function(b){b.headers=b.headers||{},b.headers["Content-Type"]=void 0,b.transformRequest=b.transformRequest||a.defaults.transformRequest;var d=new FormData,e=b.transformRequest,f=b.data;return b.transformRequest=function(a,c){if(f)if(b.formDataAppender)for(var d in f){var g=f[d];b.formDataAppender(a,d,g)}else for(var d in f){var g=f[d];if("function"==typeof e)g=e(g,c);else for(var h=0;h<e.length;h++){var i=e[h];"function"==typeof i&&(g=i(g,c))}a.append(d,g)}if(null!=b.file){var j=b.fileFormDataName||"file";if("[object Array]"===Object.prototype.toString.call(b.file))for(var k="[object String]"===Object.prototype.toString.call(j),h=0;h<b.file.length;h++)a.append(k?j+h:j[h],b.file[h],b.file[h].name);else a.append(j,b.file,b.file.name)}return a},b.data=d,c(b)},this.http=function(a){return c(a)}}]),a.directive("ngFileSelect",["$parse","$timeout",function(a,b){return function(c,d,e){var f=a(e.ngFileSelect);d.bind("change",function(a){var d,e,g=[];if(d=a.target.files,null!=d)for(e=0;e<d.length;e++)g.push(d.item(e));b(function(){f(c,{$files:g,$event:a})})}),("ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0)&&d.bind("touchend",function(a){a.preventDefault(),a.target.click()})}}]),a.directive("ngFileDropAvailable",["$parse","$timeout",function(a,b){return function(c,d,e){if("draggable"in document.createElement("span")){var f=a(e.ngFileDropAvailable);b(function(){f(c)})}}}]),a.directive("ngFileDrop",["$parse","$timeout",function(a,b){return function(c,d,e){function f(a,b){if(b.isDirectory){var c=b.createReader();i++,c.readEntries(function(b){for(var c=0;c<b.length;c++)f(a,b[c]);i--})}else i++,b.file(function(b){i--,a.push(b)})}if("draggable"in document.createElement("span")){var g=null,h=a(e.ngFileDrop);d[0].addEventListener("dragover",function(a){b.cancel(g),a.stopPropagation(),a.preventDefault(),d.addClass(e.ngFileDragOverClass||"dragover")},!1),d[0].addEventListener("dragleave",function(){g=b(function(){d.removeClass(e.ngFileDragOverClass||"dragover")})},!1);var i=0;d[0].addEventListener("drop",function(a){a.stopPropagation(),a.preventDefault(),d.removeClass(e.ngFileDragOverClass||"dragover");var g=[],j=a.dataTransfer.items;if(j&&j.length>0&&j[0].webkitGetAsEntry)for(var k=0;k<j.length;k++)f(g,j[k].webkitGetAsEntry());else{var l=a.dataTransfer.files;if(null!=l)for(var k=0;k<l.length;k++)g.push(l.item(k))}!function m(d){b(function(){i?m(10):h(c,{$files:g,$event:a})},d||0)}()},!1)}}}])}();
/*
 * AngularJS Toaster
 * Version: 2.1.0
 *
 * Copyright 2013-2016 Jiri Kavulak.
 * All Rights Reserved.
 * Use, reproduction, distribution, and modification of this code is subject to the terms and
 * conditions of the MIT license, available at http://www.opensource.org/licenses/mit-license.php
 *
 * Author: Jiri Kavulak
 * Related to project of John Papa, Hans Fjällemark and Nguyễn Thiện Hùng (thienhung1989)
 */
(function(window,document){'use strict';angular.module('toaster',[]).constant('toasterConfig',{'limit':0,'tap-to-dismiss':true,'close-button':false,'close-html':'<button class="toast-close-button" type="button">&times;</button>','newest-on-top':true,'time-out':5000,'icon-classes':{error:'toast-error',info:'toast-info',wait:'toast-wait',success:'toast-success',warning:'toast-warning'},'body-output-type':'','body-template':'toasterBodyTmpl.html','icon-class':'toast-info','position-class':'toast-top-right','title-class':'toast-title','message-class':'toast-message','prevent-duplicates':false,'mouseover-timer-stop':true }).run(['$templateCache',function($templateCache){$templateCache.put('angularjs-toaster/toast.html','<div id="toast-container" ng-class="[config.position, config.animation]"><div ng-repeat="toaster in toasters" class="toast" ng-class="toaster.type" ng-click="click($event, toaster)" ng-mouseover="stopTimer(toaster)" ng-mouseout="restartTimer(toaster)"><div ng-if="toaster.showCloseButton" ng-click="click($event, toaster, true)" ng-bind-html="toaster.closeHtml"></div><div ng-class="config.title">{{toaster.title}}</div><div ng-class="config.message" ng-switch on="toaster.bodyOutputType"><div ng-switch-when="trustedHtml" ng-bind-html="toaster.html"></div><div ng-switch-when="template"><div ng-include="toaster.bodyTemplate"></div></div><div ng-switch-when="templateWithData"><div ng-include="toaster.bodyTemplate"></div></div><div ng-switch-when="directive"><div directive-template directive-name="{{toaster.html}}" directive-data="toaster.directiveData"></div></div><div ng-switch-default >{{toaster.body}}</div></div></div></div>')}]).service('toaster',['$rootScope','toasterConfig',function($rootScope,toasterConfig){var Guid=(function(){var Guid={};Guid.newGuid=function(){return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g,function(c){var r=Math.random()*16|0,v=c=='x'?r:(r&0x3|0x8);return v.toString(16)})};return Guid}());this.pop=function(type,title,body,timeout,bodyOutputType,clickHandler,toasterId,showCloseButton,toastId,onHideCallback){if(angular.isObject(type)){var params=type;this.toast={type:params.type,title:params.title,body:params.body,timeout:params.timeout,bodyOutputType:params.bodyOutputType,clickHandler:params.clickHandler,showCloseButton:params.showCloseButton,closeHtml:params.closeHtml,toastId:params.toastId,onShowCallback:params.onShowCallback,onHideCallback:params.onHideCallback,directiveData:params.directiveData,tapToDismiss:params.tapToDismiss};toasterId=params.toasterId}else{this.toast={type:type,title:title,body:body,timeout:timeout,bodyOutputType:bodyOutputType,clickHandler:clickHandler,showCloseButton:showCloseButton,toastId:toastId,onHideCallback:onHideCallback}}if(!this.toast.toastId||!this.toast.toastId.length){this.toast.toastId=Guid.newGuid()}$rootScope.$emit('toaster-newToast',toasterId,this.toast.toastId);return{toasterId:toasterId,toastId:this.toast.toastId}};this.clear=function(toasterId,toastId){if(angular.isObject(toasterId)){$rootScope.$emit('toaster-clearToasts',toasterId.toasterId,toasterId.toastId)}else{$rootScope.$emit('toaster-clearToasts',toasterId,toastId)}};for(var type in toasterConfig['icon-classes']){this[type]=createTypeMethod(type)}function createTypeMethod(toasterType){return function(title,body,timeout,bodyOutputType,clickHandler,toasterId,showCloseButton,toastId,onHideCallback){if(angular.isString(title)){return this.pop(toasterType,title,body,timeout,bodyOutputType,clickHandler,toasterId,showCloseButton,toastId,onHideCallback)}else{return this.pop(angular.extend(title,{type:toasterType}))}}}}]).factory('toasterEventRegistry',['$rootScope',function($rootScope){var deregisterNewToast=null,deregisterClearToasts=null,newToastEventSubscribers=[],clearToastsEventSubscribers=[],toasterFactory;toasterFactory={setup:function(){if(!deregisterNewToast){deregisterNewToast=$rootScope.$on('toaster-newToast',function(event,toasterId,toastId){for(var i=0,len=newToastEventSubscribers.length;i<len;i+=1){newToastEventSubscribers[i](event,toasterId,toastId)}})}if(!deregisterClearToasts){deregisterClearToasts=$rootScope.$on('toaster-clearToasts',function(event,toasterId,toastId){for(var i=0,len=clearToastsEventSubscribers.length;i<len;i+=1){clearToastsEventSubscribers[i](event,toasterId,toastId)}})}},subscribeToNewToastEvent:function(onNewToast){newToastEventSubscribers.push(onNewToast)},subscribeToClearToastsEvent:function(onClearToasts){clearToastsEventSubscribers.push(onClearToasts)},unsubscribeToNewToastEvent:function(onNewToast){var index=newToastEventSubscribers.indexOf(onNewToast);if(index>=0){newToastEventSubscribers.splice(index,1)}if(newToastEventSubscribers.length===0){deregisterNewToast();deregisterNewToast=null}},unsubscribeToClearToastsEvent:function(onClearToasts){var index=clearToastsEventSubscribers.indexOf(onClearToasts);if(index>=0){clearToastsEventSubscribers.splice(index,1)}if(clearToastsEventSubscribers.length===0){deregisterClearToasts();deregisterClearToasts=null}}};return{setup:toasterFactory.setup,subscribeToNewToastEvent:toasterFactory.subscribeToNewToastEvent,subscribeToClearToastsEvent:toasterFactory.subscribeToClearToastsEvent,unsubscribeToNewToastEvent:toasterFactory.unsubscribeToNewToastEvent,unsubscribeToClearToastsEvent:toasterFactory.unsubscribeToClearToastsEvent}}]).directive('directiveTemplate',['$compile','$injector',function($compile,$injector){return{restrict:'A',scope:{directiveName:'@directiveName',directiveData:'=directiveData'},replace:true,link:function(scope,elm,attrs){scope.$watch('directiveName',function(directiveName){if(angular.isUndefined(directiveName)||directiveName.length<=0){throw new Error('A valid directive name must be provided via the toast body argument when using bodyOutputType: directive')}var directive;try{directive=$injector.get(attrs.$normalize(directiveName)+'Directive')}catch(e){throw new Error(directiveName+' could not be found. The name should appear as it exists in the markup, not camelCased as it would appear in the directive declaration, e.g. directive-name not directiveName.')}var directiveDetails=directive[0];if(directiveDetails.scope!==true&&directiveDetails.scope){throw new Error('Cannot use a directive with an isolated scope. The scope must be either true or falsy (e.g. false/null/undefined). Occurred for directive '+directiveName+'.')}if(directiveDetails.restrict.indexOf('A')<0){throw new Error('Directives must be usable as attributes. Add "A" to the restrict option (or remove the option entirely). Occurred for directive '+directiveName+'.')}if(scope.directiveData){scope.directiveData=angular.fromJson(scope.directiveData)}var template=$compile('<div '+directiveName+'></div>')(scope);elm.append(template)})}}}]).directive('toasterContainer',['$parse','$rootScope','$interval','$sce','toasterConfig','toaster','toasterEventRegistry',function($parse,$rootScope,$interval,$sce,toasterConfig,toaster,toasterEventRegistry){return{replace:true,restrict:'EA',scope:true,link:function(scope,elm,attrs){var mergedConfig;mergedConfig=angular.extend({},toasterConfig,scope.$eval(attrs.toasterOptions));scope.config={toasterId:mergedConfig['toaster-id'],position:mergedConfig['position-class'],title:mergedConfig['title-class'],message:mergedConfig['message-class'],tap:mergedConfig['tap-to-dismiss'],closeButton:mergedConfig['close-button'],closeHtml:mergedConfig['close-html'],animation:mergedConfig['animation-class'],mouseoverTimer:mergedConfig['mouseover-timer-stop']};scope.$on("$destroy",function(){toasterEventRegistry.unsubscribeToNewToastEvent(scope._onNewToast);toasterEventRegistry.unsubscribeToClearToastsEvent(scope._onClearToasts)});function setTimeout(toast,time){toast.timeoutPromise=$interval(function(){scope.removeToast(toast.toastId)},time,1)}scope.configureTimer=function(toast){var timeout=angular.isNumber(toast.timeout)?toast.timeout:mergedConfig['time-out'];if(typeof timeout==="object"){timeout=timeout[toast.type]}if(timeout>0){setTimeout(toast,timeout)}};function addToast(toast,toastId){toast.type=mergedConfig['icon-classes'][toast.type];if(!toast.type){toast.type=mergedConfig['icon-class']}if(mergedConfig['prevent-duplicates']===true&&scope.toasters.length){if(scope.toasters[scope.toasters.length-1].body===toast.body){return}else{var i,len,dupFound=false;for(i=0,len=scope.toasters.length;i<len;i+=1){if(scope.toasters[i].toastId===toastId){dupFound=true;break}}if(dupFound){return}}}var closeButton=mergedConfig['close-button'];if(typeof toast.showCloseButton==="boolean"){}else if(typeof closeButton==="boolean"){toast.showCloseButton=closeButton}else if(typeof closeButton==="object"){var closeButtonForType=closeButton[toast.type];if(typeof closeButtonForType!=="undefined"&&closeButtonForType!==null){toast.showCloseButton=closeButtonForType}}else{toast.showCloseButton=false}if(toast.showCloseButton){toast.closeHtml=$sce.trustAsHtml(toast.closeHtml||scope.config.closeHtml)}toast.bodyOutputType=toast.bodyOutputType||mergedConfig['body-output-type'];switch(toast.bodyOutputType){case 'trustedHtml':toast.html=$sce.trustAsHtml(toast.body);break;case 'template':toast.bodyTemplate=toast.body||mergedConfig['body-template'];break;case 'templateWithData':var fcGet=$parse(toast.body||mergedConfig['body-template']);var templateWithData=fcGet(scope);toast.bodyTemplate=templateWithData.template;toast.data=templateWithData.data;break;case 'directive':toast.html=toast.body;break}scope.configureTimer(toast);if(mergedConfig['newest-on-top']===true){scope.toasters.unshift(toast);if(mergedConfig['limit']>0&&scope.toasters.length>mergedConfig['limit']){scope.toasters.pop()}}else{scope.toasters.push(toast);if(mergedConfig['limit']>0&&scope.toasters.length>mergedConfig['limit']){scope.toasters.shift()}}if(angular.isFunction(toast.onShowCallback)){toast.onShowCallback()}}scope.removeToast=function(toastId){var i,len;for(i=0,len=scope.toasters.length;i<len;i+=1){if(scope.toasters[i].toastId===toastId){removeToast(i);break}}};function removeToast(toastIndex){var toast=scope.toasters[toastIndex];if(toast.timeoutPromise){$interval.cancel(toast.timeoutPromise)}scope.toasters.splice(toastIndex,1);if(angular.isFunction(toast.onHideCallback)){toast.onHideCallback()}}function removeAllToasts(toastId){for(var i=scope.toasters.length-1;i>=0;i-=1){if(isUndefinedOrNull(toastId)){removeToast(i)}else{if(scope.toasters[i].toastId==toastId){removeToast(i)}}}}scope.toasters=[];function isUndefinedOrNull(val){return angular.isUndefined(val)||val===null}scope._onNewToast=function(event,toasterId,toastId){if((isUndefinedOrNull(scope.config.toasterId)&&isUndefinedOrNull(toasterId))||(!isUndefinedOrNull(scope.config.toasterId)&&!isUndefinedOrNull(toasterId)&&scope.config.toasterId==toasterId)){addToast(toaster.toast,toastId)}};scope._onClearToasts=function(event,toasterId,toastId){if(toasterId=='*'||(isUndefinedOrNull(scope.config.toasterId)&&isUndefinedOrNull(toasterId))||(!isUndefinedOrNull(scope.config.toasterId)&&!isUndefinedOrNull(toasterId)&&scope.config.toasterId==toasterId)){removeAllToasts(toastId)}};toasterEventRegistry.setup();toasterEventRegistry.subscribeToNewToastEvent(scope._onNewToast);toasterEventRegistry.subscribeToClearToastsEvent(scope._onClearToasts)},controller:['$scope','$element','$attrs',function($scope,$element,$attrs){$scope.stopTimer=function(toast){if($scope.config.mouseoverTimer===true){if(toast.timeoutPromise){$interval.cancel(toast.timeoutPromise);toast.timeoutPromise=null}}};$scope.restartTimer=function(toast){if($scope.config.mouseoverTimer===true){if(!toast.timeoutPromise){$scope.configureTimer(toast)}}else if(toast.timeoutPromise===null){$scope.removeToast(toast.toastId)}};$scope.click=function(event,toast,isCloseButton){event.stopPropagation();var tapToDismiss=typeof toast.tapToDismiss==="boolean"?toast.tapToDismiss:$scope.config.tap;if(tapToDismiss===true||(toast.showCloseButton===true&&isCloseButton===true)){var removeToast=true;if(toast.clickHandler){if(angular.isFunction(toast.clickHandler)){removeToast=toast.clickHandler(toast,isCloseButton)}else if(angular.isFunction($scope.$parent.$eval(toast.clickHandler))){removeToast=$scope.$parent.$eval(toast.clickHandler)(toast,isCloseButton)}else{console.log("TOAST-NOTE: Your click handler is not inside a parent scope of toaster-container.")}}if(removeToast){$scope.removeToast(toast.toastId)}}}}],templateUrl:'angularjs-toaster/toast.html'}}])})(window,document);
