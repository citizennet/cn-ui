{"version":3,"sources":["cn-ui.min.js","_cn-ui.module.js","cn-checkbox.directive.js","cn-country-select.directive.js","cn-csv-upload.directive.js","cn-currency.directive.js","cn-file-upload.directive.js","cn-iframe-height.directive.js","cn-link-to-fb.directive.js","cn-loading-bar.directive.js","cn-media-upload.directive.js","cn-modal.js","cn-pagination.directive.js","cn-parent-width.directive.js","cn-percentage.directive.js","cn-progress-bar.directive.js","cn-radio.directive.js","cn-responsive-height.directive.js","cn-select-or.directive.js","cn-toggle-switch.directive.js","cn-truncate.directive.js","cn-xls-to-json.directive.js"],"names":["angular","module","directive","restrict","link","$scope","elem","prop","after","find","template","scope","id","ngModel","csvUpload","cnUploadPath","Link","controller","Upload","controllerAs","bindToController","attrs","ctrl","$watch","newVal","prevVal","onChange","$value","$parent","$setValidity","_","isEmpty","vm","equals","$setDirty","$q","$http","$sce","cfpLoadingBar","uploadFile","$files","dfr","defer","promise","then","setModelValue","complete","formData","FormData","append","$","ajax","url","headers","defaults","common","data","processData","contentType","type","success","resolve","error","reject","start","response","this","$inject","cnCurrencyFormat","$compile","activate","placeholder","formatVal","attr","on","el","test","value","overflow","match","$parsers","unshift","parseVal","$formatters","val","format","multiply","parseFloat","floor","cnCurrencyPlaceholder","require","replace","btnStyle","iconStyle","callback","inputId","btnText","compile","uniqueId","btn","file","click","onFileSelect","cnIframeHeight","$timeout","body","getBody","height","h","scrollHeight","element","insurance","get","contentDocument","ngSrc","base","fbObject","text","twitterLink","has","fbCampaignGroupId","fbCampaignId","adSet","fbAdgroupId","run","$interval","interval","progress","numerator","denominator","counter","stop","console","log","cancel","oldVal","$on","mediaUpload","cnFileType","cnPreviewPath","cnModelValueKey","cnData","setFilePath","each","key","filePath","trustAsResourceUrl","cnModal","$modal","$rootScope","open","options","onChangeState","modal","close","factory","cnPagination","paging","onClick","count","buildPaging","pages","i","skip","last","l","push","label","disabled","active","cnParentWidth","$window","width","parent","w","bind","cnPercentageFormat","divide","$modelValue","limit","projected","flexWidth","calculateWidth","percentage","projectedBar","progressBar","css","cnResponsiveHeight","linkFunction","innerWidth","breakpoint","topOffset","offset","top","bottomOffset","max-height","sm","md","lg","cnResponsiveBreak","cnSelectOr","tpl","transclude","selectFrom","form","directiveId","toggleText","itemTemplate","SelectOr","validate","cur","prev","required","$interpolate","schema","_required","clone","processTemplate","item","trustAsHtml","onSelectionChange","selected","setValue","first","valueProperty","toggleView","view","length","onValue","offValue","undefinedClass","isUndefined","currentCssState","toggle","$event","preventDefault","stopImmediatePropagation","size","show","truncate","truncated","ogText","shortText","substr","xlsToJsonDirective","xlsToJsonController","convertXLS","f","reader","FileReader","name","onload","e","target","result","workbook","XLSX","read","json","SheetNames","map","sheetName","utils","sheet_to_json","Sheets","jsonData","readAsBinaryString"],"mappings":"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","file":"cn-ui.min.js","sourcesContent":["'use strict';\n\n(function () {\n  'use strict';\n\n  angular.module('cn.ui', []);\n})();\n'use strict';\n\n(function () {\n  'use strict';\n\n  angular.module('cn.ui').directive('checkbox', function () {\n    return {\n      restrict: 'C',\n      link: function link($scope, elem) {\n        if (elem.prop('tagName') === 'INPUT') {\n          elem.after('<span></span>');\n        } else {\n          elem.find('input[type=checkbox]').after('<span></span>');\n        }\n      }\n    };\n  });\n})();\n'use strict';\n\n(function () {\n  'use strict';\n\n  angular.module('cn.ui').directive('countrySelect', function () {\n    return {\n      restrict: 'E',\n      template: '<label for=\"{{id || \\'country\\'}}\">Country</label>\\\n                     <select id=\"{{id || \\'country\\'}}\" ng-model=\"ngModel\" class=\"form-control\">\\\n                       <option value=\"US\">United States</option>\\\n                       <option value=\"AF\">Afghanistan</option>\\\n                       <option value=\"AL\">Albania</option>\\\n                       <option value=\"DZ\">Algeria</option>\\\n                       <option value=\"AS\">American Samoa</option>\\\n                       <option value=\"AD\">Andorra</option>\\\n                       <option value=\"AO\">Angola</option>\\\n                       <option value=\"AI\">Anguilla</option>\\\n                       <option value=\"AQ\">Antarctica</option>\\\n                       <option value=\"AG\">Antigua And Barbuda</option>\\\n                       <option value=\"AR\">Argentina</option>\\\n                       <option value=\"AM\">Armenia</option>\\\n                       <option value=\"AW\">Aruba</option>\\\n                       <option value=\"AU\">Australia</option>\\\n                       <option value=\"AT\">Austria</option>\\\n                       <option value=\"AZ\">Azerbaijan</option>\\\n                       <option value=\"BS\">Bahamas</option>\\\n                       <option value=\"BH\">Bahrain</option>\\\n                       <option value=\"BD\">Bangladesh</option>\\\n                       <option value=\"BB\">Barbados</option>\\\n                       <option value=\"BY\">Belarus</option>\\\n                       <option value=\"BE\">Belgium</option>\\\n                       <option value=\"BZ\">Belize</option>\\\n                       <option value=\"BJ\">Benin</option>\\\n                       <option value=\"BM\">Bermuda</option>\\\n                       <option value=\"BT\">Bhutan</option>\\\n                       <option value=\"BO\">Bolivia</option>\\\n                       <option value=\"BA\">Bosnia And Herzegovina</option>\\\n                       <option value=\"BW\">Botswana</option>\\\n                       <option value=\"BV\">Bouvet Island</option>\\\n                       <option value=\"BR\">Brazil</option>\\\n                       <option value=\"IO\">British Indian Ocean Territory</option>\\\n                       <option value=\"BN\">Brunei Darussalam</option>\\\n                       <option value=\"BG\">Bulgaria</option>\\\n                       <option value=\"BF\">Burkina Faso</option>\\\n                       <option value=\"BI\">Burundi</option>\\\n                       <option value=\"KH\">Cambodia</option>\\\n                       <option value=\"CM\">Cameroon</option>\\\n                       <option value=\"CA\">Canada</option>\\\n                       <option value=\"CV\">Cape Verde</option>\\\n                       <option value=\"KY\">Cayman Islands</option>\\\n                       <option value=\"CF\">Central African Republic</option>\\\n                       <option value=\"TD\">Chad</option>\\\n                       <option value=\"CL\">Chile</option>\\\n                       <option value=\"CN\">China</option>\\\n                       <option value=\"CX\">Christmas Island</option>\\\n                       <option value=\"CC\">Cocos (keeling) Islands</option>\\\n                       <option value=\"CO\">Colombia</option>\\\n                       <option value=\"KM\">Comoros</option>\\\n                       <option value=\"CG\">Congo</option>\\\n                       <option value=\"CK\">Cook Islands</option>\\\n                       <option value=\"CR\">Costa Rica</option>\\\n                       <option value=\"CI\">Cote D Ivoire</option>\\\n                       <option value=\"HR\">Croatia</option>\\\n                       <option value=\"CU\">Cuba</option>\\\n                       <option value=\"CY\">Cyprus</option>\\\n                       <option value=\"CZ\">Czech Republic</option>\\\n                       <option value=\"DK\">Denmark</option>\\\n                       <option value=\"DJ\">Djibouti</option>\\\n                       <option value=\"DM\">Dominica</option>\\\n                       <option value=\"DO\">Dominican Republic</option>\\\n                       <option value=\"TP\">East Timor</option>\\\n                       <option value=\"EC\">Ecuador</option>\\\n                       <option value=\"EG\">Egypt</option>\\\n                       <option value=\"SV\">El Salvador</option>\\\n                       <option value=\"GQ\">Equatorial Guinea</option>\\\n                       <option value=\"ER\">Eritrea</option>\\\n                       <option value=\"EE\">Estonia</option>\\\n                       <option value=\"ET\">Ethiopia</option>\\\n                       <option value=\"FK\">Falkland Islands (malvinas)</option>\\\n                       <option value=\"FO\">Faroe Islands</option>\\\n                       <option value=\"FJ\">Fiji</option>\\\n                       <option value=\"FI\">Finland</option>\\\n                       <option value=\"FR\">France</option>\\\n                       <option value=\"GF\">French Guiana</option>\\\n                       <option value=\"PF\">French Polynesia</option>\\\n                       <option value=\"TF\">French Southern Territories</option>\\\n                       <option value=\"GA\">Gabon</option>\\\n                       <option value=\"GM\">Gambia</option>\\\n                       <option value=\"GE\">Georgia</option>\\\n                       <option value=\"DE\">Germany</option>\\\n                       <option value=\"GH\">Ghana</option>\\\n                       <option value=\"GI\">Gibraltar</option>\\\n                       <option value=\"GR\">Greece</option>\\\n                       <option value=\"GL\">Greenland</option>\\\n                       <option value=\"GD\">Grenada</option>\\\n                       <option value=\"GP\">Guadeloupe</option>\\\n                       <option value=\"GU\">Guam</option>\\\n                       <option value=\"GT\">Guatemala</option>\\\n                       <option value=\"GN\">Guinea</option>\\\n                       <option value=\"GW\">Guinea-bissau</option>\\\n                       <option value=\"GY\">Guyana</option>\\\n                       <option value=\"HT\">Haiti</option>\\\n                       <option value=\"VA\">Holy See (vatican City State)</option>\\\n                       <option value=\"HN\">Honduras</option>\\\n                       <option value=\"HK\">Hong Kong</option>\\\n                       <option value=\"HU\">Hungary</option>\\\n                       <option value=\"IS\">Iceland</option>\\\n                       <option value=\"IN\">India</option>\\\n                       <option value=\"ID\">Indonesia</option>\\\n                       <option value=\"IR\">Iran, Islamic Republic Of</option>\\\n                       <option value=\"IQ\">Iraq</option>\\\n                       <option value=\"IE\">Ireland</option>\\\n                       <option value=\"IL\">Israel</option>\\\n                       <option value=\"IT\">Italy</option>\\\n                       <option value=\"JM\">Jamaica</option>\\\n                       <option value=\"JP\">Japan</option>\\\n                       <option value=\"JO\">Jordan</option>\\\n                       <option value=\"KZ\">Kazakstan</option>\\\n                       <option value=\"KE\">Kenya</option>\\\n                       <option value=\"KI\">Kiribati</option>\\\n                       <option value=\"KP\">Korea Democratic Peoples Republic Of</option>\\\n                       <option value=\"KR\">Korea Republic Of</option>\\\n                       <option value=\"KW\">Kuwait</option>\\\n                       <option value=\"KG\">Kyrgyzstan</option>\\\n                       <option value=\"LA\">Lao Peoples Democratic Republic</option>\\\n                       <option value=\"LV\">Latvia</option>\\\n                       <option value=\"LB\">Lebanon</option>\\\n                       <option value=\"LS\">Lesotho</option>\\\n                       <option value=\"LR\">Liberia</option>\\\n                       <option value=\"LY\">Libyan Arab Jamahiriya</option>\\\n                       <option value=\"LI\">Liechtenstein</option>\\\n                       <option value=\"LT\">Lithuania</option>\\\n                       <option value=\"LU\">Luxembourg</option>\\\n                       <option value=\"MO\">Macau</option>\\\n                       <option value=\"MK\">Macedonia</option>\\\n                       <option value=\"MG\">Madagascar</option>\\\n                       <option value=\"MW\">Malawi</option>\\\n                       <option value=\"MY\">Malaysia</option>\\\n                       <option value=\"MV\">Maldives</option>\\\n                       <option value=\"ML\">Mali</option>\\\n                       <option value=\"MT\">Malta</option>\\\n                       <option value=\"MH\">Marshall Islands</option>\\\n                       <option value=\"MQ\">Martinique</option>\\\n                       <option value=\"MR\">Mauritania</option>\\\n                       <option value=\"MU\">Mauritius</option>\\\n                       <option value=\"YT\">Mayotte</option>\\\n                       <option value=\"MX\">Mexico</option>\\\n                       <option value=\"FM\">Micronesia, Federated States Of</option>\\\n                       <option value=\"MD\">Moldova, Republic Of</option>\\\n                       <option value=\"MC\">Monaco</option>\\\n                       <option value=\"MN\">Mongolia</option>\\\n                       <option value=\"MS\">Montserrat</option>\\\n                       <option value=\"MA\">Morocco</option>\\\n                       <option value=\"MZ\">Mozambique</option>\\\n                       <option value=\"MM\">Myanmar</option>\\\n                       <option value=\"NA\">Namibia</option>\\\n                       <option value=\"NR\">Nauru</option>\\\n                       <option value=\"NP\">Nepal</option>\\\n                       <option value=\"NL\">Netherlands</option>\\\n                       <option value=\"AN\">Netherlands Antilles</option>\\\n                       <option value=\"NC\">New Caledonia</option>\\\n                       <option value=\"NZ\">New Zealand</option>\\\n                       <option value=\"NI\">Nicaragua</option>\\\n                       <option value=\"NE\">Niger</option>\\\n                       <option value=\"NG\">Nigeria</option>\\\n                       <option value=\"NU\">Niue</option>\\\n                       <option value=\"NF\">Norfolk Island</option>\\\n                       <option value=\"MP\">Northern Mariana Islands</option>\\\n                       <option value=\"NO\">Norway</option>\\\n                       <option value=\"OM\">Oman</option>\\\n                       <option value=\"PK\">Pakistan</option>\\\n                       <option value=\"PW\">Palau</option>\\\n                       <option value=\"PS\">Palestinian Territory, Occupied</option>\\\n                       <option value=\"PA\">Panama</option>\\\n                       <option value=\"PG\">Papua New Guinea</option>\\\n                       <option value=\"PY\">Paraguay</option>\\\n                       <option value=\"PE\">Peru</option>\\\n                       <option value=\"PH\">Philippines</option>\\\n                       <option value=\"PN\">Pitcairn</option>\\\n                       <option value=\"PL\">Poland</option>\\\n                       <option value=\"PT\">Portugal</option>\\\n                       <option value=\"PR\">Puerto Rico</option>\\\n                       <option value=\"QA\">Qatar</option>\\\n                       <option value=\"RE\">Reunion</option>\\\n                       <option value=\"RO\">Romania</option>\\\n                       <option value=\"RU\">Russian Federation</option>\\\n                       <option value=\"RW\">Rwanda</option>\\\n                       <option value=\"SH\">Saint Helena</option>\\\n                       <option value=\"KN\">Saint Kitts And Nevis</option>\\\n                       <option value=\"LC\">Saint Lucia</option>\\\n                       <option value=\"PM\">Saint Pierre And Miquelon</option>\\\n                       <option value=\"VC\">Saint Vincent And The Grenadines</option>\\\n                       <option value=\"WS\">Samoa</option>\\\n                       <option value=\"SM\">San Marino</option>\\\n                       <option value=\"ST\">Sao Tome And Principe</option>\\\n                       <option value=\"SA\">Saudi Arabia</option>\\\n                       <option value=\"SN\">Senegal</option>\\\n                       <option value=\"SC\">Seychelles</option>\\\n                       <option value=\"SL\">Sierra Leone</option>\\\n                       <option value=\"SG\">Singapore</option>\\\n                       <option value=\"SK\">Slovakia</option>\\\n                       <option value=\"SI\">Slovenia</option>\\\n                       <option value=\"SB\">Solomon Islands</option>\\\n                       <option value=\"SO\">Somalia</option>\\\n                       <option value=\"ZA\">South Africa</option>\\\n                       <option value=\"GS\">South Georgia</option>\\\n                       <option value=\"ES\">Spain</option>\\\n                       <option value=\"LK\">Sri Lanka</option>\\\n                       <option value=\"SD\">Sudan</option>\\\n                       <option value=\"SR\">Suriname</option>\\\n                       <option value=\"SJ\">Svalbard And Jan Mayen</option>\\\n                       <option value=\"SZ\">Swaziland</option>\\\n                       <option value=\"SE\">Sweden</option>\\\n                       <option value=\"CH\">Switzerland</option>\\\n                       <option value=\"SY\">Syrian Arab Republic</option>\\\n                       <option value=\"TW\">Taiwan, Province Of China</option>\\\n                       <option value=\"TJ\">Tajikistan</option>\\\n                       <option value=\"TZ\">Tanzania, United Republic Of</option>\\\n                       <option value=\"TH\">Thailand</option>\\\n                       <option value=\"TG\">Togo</option>\\\n                       <option value=\"TK\">Tokelau</option>\\\n                       <option value=\"TO\">Tonga</option>\\\n                       <option value=\"TT\">Trinidad And Tobago</option>\\\n                       <option value=\"TN\">Tunisia</option>\\\n                       <option value=\"TR\">Turkey</option>\\\n                       <option value=\"TM\">Turkmenistan</option>\\\n                       <option value=\"TC\">Turks And Caicos Islands</option>\\\n                       <option value=\"TV\">Tuvalu</option>\\\n                       <option value=\"UG\">Uganda</option>\\\n                       <option value=\"UA\">Ukraine</option>\\\n                       <option value=\"AE\">United Arab Emirates</option>\\\n                       <option value=\"GB\">United Kingdom</option>\\\n                       <option value=\"UM\">United States Minor Outlying Islands</option>\\\n                       <option value=\"UY\">Uruguay</option>\\\n                       <option value=\"UZ\">Uzbekistan</option>\\\n                       <option value=\"VU\">Vanuatu</option>\\\n                       <option value=\"VE\">Venezuela</option>\\\n                       <option value=\"VN\">Viet Nam</option>\\\n                       <option value=\"VG\">Virgin Islands, British</option>\\\n                       <option value=\"VI\">Virgin Islands, U.s.</option>\\\n                       <option value=\"WF\">Wallis And Futuna</option>\\\n                       <option value=\"EH\">Western Sahara</option>\\\n                       <option value=\"YE\">Yemen</option>\\\n                       <option value=\"YU\">Yugoslavia</option>\\\n                       <option value=\"ZM\">Zambia</option>\\\n                       <option value=\"ZW\">Zimbabwe</option>\\\n                     </select>',\n      scope: {\n        id: '&?',\n        ngModel: '='\n      }\n    };\n  });\n})();\n'use strict';\n\n(function () {\n  \"use strict\";\n\n  angular.module('cn.ui').directive('csvUpload', csvUpload);\n\n  function csvUpload() {\n    return {\n      restrict: 'E',\n      scope: {\n        cnUploadPath: '=',\n        ngModel: '='\n      },\n      link: Link,\n      controller: Upload,\n      controllerAs: 'vm',\n      bindToController: true,\n      template: '\\\n        <file-upload class=\"col-sm-6\"\\\n                     btn-text=\"Upload CSV\"\\\n                     on-file-select=\"vm.uploadFile($files)\">\\\n        </file-upload>\\\n      '\n    };\n  }\n\n  function Link($scope, elem, attrs, ctrl) {\n    $scope.$watch('vm.ngModel', function (newVal, prevVal) {\n      if ($scope.onChange) {\n        $scope.onChange({ $value: newVal });\n      }\n      $scope.$parent.$parent.ngModel.$setValidity('schemaForm', true);\n      $scope.$parent.$parent.ngModel.$setValidity('tv4-302', !_.isEmpty($scope.vm.ngModel));\n      if (!angular.equals(newVal, prevVal)) {\n        $scope.$parent.$parent.ngModel.$setDirty();\n      }\n    });\n  }\n\n  Upload.$inject = ['$q', '$http', '$sce', 'cfpLoadingBar'];\n  function Upload($q, $http, $sce, cfpLoadingBar) {\n    var vm = this;\n\n    vm.uploadFile = uploadFile;\n\n    function uploadFile($files) {\n      var dfr = $q.defer();\n      dfr.promise.then(setModelValue, cfpLoadingBar.complete);\n\n      var formData = new FormData();\n      formData.append('csv', $files[0]);\n\n      $.ajax({\n        url: vm.cnUploadPath,\n        headers: $http.defaults.headers.common,\n        data: formData,\n        processData: false,\n        contentType: false,\n        type: 'POST',\n        success: dfr.resolve,\n        error: dfr.reject\n      });\n\n      cfpLoadingBar.start();\n    }\n\n    function setModelValue(response) {\n      cfpLoadingBar.complete();\n      vm.ngModel = response;\n    }\n  }\n})();\n'use strict';\n\n(function () {\n  'use strict';\n\n  angular.module('cn.ui').directive('cnCurrencyFormat', cnCurrencyFormat);\n\n  cnCurrencyFormat.$inject = ['$compile'];\n  function cnCurrencyFormat($compile) {\n    return {\n      require: '?ngModel',\n      link: link\n    };\n\n    function link($scope, elem, attrs, vm) {\n      if (!vm) return;\n\n      var format = attrs.cnCurrencyFormat;\n      var placeholder = attrs.cnCurrencyPlaceholder;\n\n      activate();\n\n      //////////\n\n      function activate() {\n        if (placeholder) {\n          placeholder = formatVal(placeholder);\n          elem.attr('placeholder', placeholder);\n        }\n\n        elem.on('blur', function (el) {\n          if (/\\.\\d$/.test(elem[0].value)) return elem[0].value += '0';\n\n          var overflow = elem[0].value.match(/(\\d*\\.\\d{2})(.+)/);\n          if (overflow) elem[0].value = overflow[1];\n        });\n\n        vm.$parsers.unshift(parseVal);\n        vm.$formatters.unshift(function (val) {\n          //console.log('val:', val);\n          vm.$setDirty();\n          return formatVal(val);\n        });\n      }\n\n      function parseVal(val) {\n        if (!val) return 0;\n        if (format === 'cents') {\n          return _.multiply(val, 100);\n        }\n        if (format === 'microcents') {\n          return _.multiply(val, 1000000);\n        }\n        return parseFloat(val);\n      }\n\n      function formatVal(val) {\n        if (!val) val = '';else if (format === 'cents') {\n          val = _.floor(val / 100, 2) || '';\n        } else if (format === 'microcents') {\n          val = _.floor(val / 1000000, 2) || '';\n        } else {\n          val = _.floor(val, 2) || '';\n        }\n        return (/\\.\\d$/.test(val) ? val + '0' : val\n        );\n      }\n    }\n  }\n})();\n'use strict';\n\n(function () {\n  'use strict';\n\n  angular.module('cn.ui').directive('fileUpload', function () {\n    return {\n      restrict: 'E',\n      replace: true,\n      scope: {\n        btnStyle: '@',\n        iconStyle: '@',\n        callback: '&onFileSelect',\n        inputId: '@',\n        btnText: '@'\n      },\n      template: '<div class=\"file-wrapper\">\\\n                       <button class=\"btn btn-file {{btnStyle}}\">\\\n                         <i ng-if=\"iconStyle\" class=\"{{iconStyle}}\"></i> {{btnText}}\\\n                       </button>\\\n                       <input type=\"file\" id=\"{{inputId}}\" class=\"form-control\" \\\n                              ng-file-select=\"onFileSelect($files)\"/>\\\n                     </div>',\n      compile: function compile(elem, attrs) {\n        attrs.btnStyle = /btn-(primary|success|info|warning|danger|link)/.test(attrs.btnStyle) ? attrs.btnStyle : attrs.btnStyle + ' btn-default';\n        attrs.inputId = attrs.inputId || 'file-' + _.uniqueId();\n        attrs.btnText = attrs.btnText || 'Choose a file...';\n\n        return function link($scope, elem) {\n          var btn = elem.find('button'),\n              file = elem.find('input');\n\n          btn.click(function () {\n            file.click();\n          });\n\n          $scope.onFileSelect = function ($files) {\n            $scope.callback({ $files: $files });\n          };\n        };\n      }\n    };\n  });\n})();\n'use strict';\n\n(function () {\n  'use strict';\n\n  angular.module('cn.ui').directive('cnIframeHeight', cnIframeHeight);\n\n  cnIframeHeight.$inject = ['$timeout'];\n  function cnIframeHeight($timeout) {\n    return {\n      restrict: 'A',\n      link: Link\n    };\n\n    function Link($scope, elem, attrs) {\n      var body, $body, h;\n      var insurance;\n\n      $scope.$watch(function () {\n        return attrs.ngSrc;\n      }, function () {\n        if (attrs.ngSrc) {\n          insurance = 0;\n          $timeout(activate, 100);\n        }\n      });\n\n      ////////\n\n      function activate() {\n        body = getBody();\n        if (body) {\n          elem.height('');\n          h = body.scrollHeight;\n          elem.height(h);\n          angular.element(body).find('img').on('load', activate);\n          if (!insurance) {\n            ++insurance;\n            $timeout(activate, 200);\n            $timeout(activate, 500);\n            $timeout(activate, 1000);\n            $timeout(activate, 1500);\n            $timeout(activate, 3500);\n            $timeout(activate, 5000);\n            $timeout(activate, 7500);\n            $timeout(activate, 10000);\n          }\n          return;\n        }\n        $timeout(activate, 100);\n      }\n\n      function getBody() {\n        return elem.get(0).contentDocument && elem.get(0).contentDocument.body;\n      }\n    }\n  }\n})();\n'use strict';\n\n(function () {\n  'use strict';\n\n  angular.module('cn.ui').directive('linkToFacebook', function () {\n\n    var base = 'https://www.facebook.com/ads/manage/summary/';\n\n    return {\n      restrict: 'E',\n      replace: true,\n      template: '<a href=\"{{ link }}\" target=\"_blank\" ng-show=\"link\" ng-click=\"$event.stopPropagation();\">\\\n                       {{text}}\\\n                       <span class=\"glyphicon glyphicon-new-window small\"></span>\\\n                     </a>',\n      scope: {\n        'fbObject': '=',\n        'text': '@?'\n      },\n\n      link: function link($scope) {\n        if ($scope.fbObject.twitterLink) {\n          $scope.link = $scope.fbObject.twitterLink;\n        } else if (_.has($scope.fbObject, 'fbCampaignGroupId')) {\n          if ($scope.fbObject.fbCampaignGroupId) {\n            $scope.link = base + 'campaign/?campaign_id=' + $scope.fbObject.fbCampaignGroupId;\n          }\n        } else if (_.has($scope.fbObject, 'fbCampaignId')) {\n          if ($scope.fbObject.fbCampaignId) {\n            $scope.link = base + 'adset/?ad_set_id=' + $scope.fbObject.fbCampaignId;\n          }\n        } else if (_.has($scope.fbObject, 'fbAdgroupId')) {\n          if ($scope.fbObject.adSet.fbCampaignId && $scope.fbObject.fbAdgroupId) {\n            $scope.link = base + 'adset/?ad_set_id=' + $scope.fbObject.adSet.fbCampaignId + '&show_adgroup_id=' + $scope.fbObject.fbAdgroupId;\n          }\n        }\n      }\n    };\n  });\n})();\n'use strict';\n\n(function () {\n  'use strict';\n\n  angular.module('cn.ui').directive('cnLoadingBar', function () {\n    return {\n      restrict: 'E',\n      replace: true,\n      scope: {\n        run: '='\n      },\n      template: '<div><cn-progress-bar cn-limit=\"1\" cn-progress=\"progress\"></cn-progress-bar></div>',\n      controller: ['$scope', '$interval', function ($scope, $interval) {\n        $scope.progress = 0;\n        $scope.counter = 1;\n        $scope.numerator = 1;\n        $scope.denominator = 3;\n\n        $scope.$watch('run', function (newVal, oldVal) {\n          console.log('run:', $scope.run);\n          if (newVal === oldVal) return;\n          if ($scope.run) {\n            start();\n          } else {\n            stop();\n          }\n        });\n\n        function start() {\n          $scope.interval = $interval(function () {\n            $scope.progress = $scope.progress + $scope.numerator / $scope.denominator;\n            $scope.denominator = $scope.denominator + 2 / $scope.counter;\n            $scope.counter = $scope.counter * 0.66;\n          }, 500);\n        }\n\n        function stop() {\n          console.log('stop:', $scope.interval);\n          $interval.cancel($scope.interval);\n          $scope.progress = 100;\n        }\n\n        $scope.$on('$destroy', function () {\n          stop();\n        });\n      }]\n    };\n  });\n})();\n'use strict';\n\n(function () {\n  \"use strict\";\n\n  angular.module('cn.ui').directive('mediaUpload', mediaUpload);\n\n  function mediaUpload() {\n    return {\n      restrict: 'E',\n      scope: {\n        cnUploadPath: '=',\n        cnFileType: '=',\n        cnPreviewPath: '=',\n        cnModelValueKey: '=',\n        ngModel: '=',\n        cnData: '='\n      },\n      controller: Upload,\n      controllerAs: 'vm',\n      bindToController: true,\n      template: '\\\n        <div class=\"img-placeholder col-sm-6\" ng-class=\"{ empty: !vm.filePath }\">\\\n          <img ng-if=\"vm.cnFileType === \\'image\\'\" ng-src=\"{{vm.filePath}}\"/>\\\n          <video ng-if=\"vm.cnFileType === \\'video\\' && vm.filePath\"\\\n                 ng-src=\"{{vm.filePath}}\"\\\n                 controls=\"controls\"/>\\\n        </div>\\\n        <file-upload class=\"col-sm-6\"\\\n                     btn-text=\"Upload {{vm.cnFileType | titleCase}}\"\\\n                     on-file-select=\"vm.uploadFile($files)\">\\\n        </file-upload>\\\n      '\n    };\n  }\n\n  Upload.$inject = ['$q', '$http', '$sce', 'cfpLoadingBar'];\n  function Upload($q, $http, $sce, cfpLoadingBar) {\n    var vm = this;\n\n    vm.uploadFile = uploadFile;\n\n    function uploadFile($files) {\n      var dfr = $q.defer();\n      dfr.promise.then(setFilePath, cfpLoadingBar.complete);\n\n      var formData = new FormData();\n      formData.append(vm.cnFileType, $files[0]);\n\n      _.each(vm.cnData, function (value, key) {\n        if (value) formData.append(key, value);\n      });\n\n      $.ajax({\n        url: vm.cnUploadPath,\n        headers: $http.defaults.headers.common,\n        data: formData,\n        processData: false,\n        contentType: false,\n        type: 'POST',\n        success: dfr.resolve,\n        error: dfr.reject\n      });\n\n      cfpLoadingBar.start();\n    }\n\n    function setFilePath(response) {\n      cfpLoadingBar.complete();\n      vm.ngModel = response[vm.cnModelValueKey || 'media_id_string'];\n      vm.filePath = $sce.trustAsResourceUrl(response[vm.cnPreviewPath || 'cn_preview_url']);\n    }\n  }\n})();\n'use strict';\n\n(function () {\n  'use strict';\n\n  angular.module('cn.ui').factory('cnModal', cnModal);\n\n  cnModal.$inject = ['$modal', '$rootScope'];\n  function cnModal($modal, $rootScope) {\n    var vm = {\n      onChangeState: null,\n      open: open\n    };\n\n    return vm;\n\n    ////////\n\n    function open(options) {\n      vm.onChangeState = $rootScope.$on('$stateChangeStart', function () {\n        console.log('changeState:', vm.modal);\n        vm.onChangeState();\n        if (vm.modal) {\n          vm.modal.close();\n        }\n      });\n      vm.modal = $modal.open(options);\n      return vm.modal;\n    }\n  }\n})();\n'use strict';\n\n(function () {\n  'use strict';\n\n  angular.module('cn.ui').directive('cnPagination', cnPagination);\n\n  function cnPagination() {\n    return {\n      restrict: 'E',\n      replace: true,\n      template: '\\\n          <div class=\"cn-pagination clearfix\"><div ng-if=\"paging\">\\\n            <div class=\"btn-group\" ng-if=\"count\">\\\n              <button type=\"button\" \\\n                      class=\"btn btn-sm btn-primary dropdown-toggle\" \\\n                      data-toggle=\"dropdown\">\\\n                {{count}} Results <span class=\"caret\"></span>\\\n              </button>\\\n              <ul class=\"dropdown-menu\" role=\"menu\">\\\n                <li><a ng-click=\"onClick(1, 10)\">10 Results</a></li>\\\n                <li><a ng-click=\"onClick(1, 25)\">25 Results</a></li>\\\n                <li><a ng-click=\"onClick(1, 50)\">50 Results</a></li>\\\n              </ul>\\\n            </div>\\\n            <ul class=\"pagination\" ng-if=\"pages.length > 1\">\\\n              <li ng-repeat=\"page in pages\"\\\n                  ng-class=\"{active: page.active}\">\\\n                <a ng-if=\"!page.disabled\"\\\n                   ng-click=\"page.skip && onClick(page.skip)\">{{page.label}}</a>\\\n                <span ng-if=\"page.disabled\">{{page.label}}</span>\\\n              </li>\\\n            </ul>\\\n          </div></div>',\n      scope: {\n        paging: '=',\n        onClick: '=',\n        count: '=?'\n      },\n      link: function link($scope) {\n\n        $scope.$watch('paging', function () {\n          if ($scope.paging) {\n            $scope.pages = buildPaging($scope.paging);\n          }\n        });\n\n        function buildPaging(paging) {\n          var pages = [],\n              i = paging.skip < 4 ? 1 : paging.skip > paging.last - 3 ? paging.last - 4 : paging.skip - 2,\n              l = paging.last + 1 > i + 5 ? i + 5 : paging.last + 1;\n\n          if (paging.skip !== 1) {\n            pages.push({\n              label: '←',\n              skip: paging.skip - 1\n            });\n          }\n\n          if (1 < i) {\n            pages.push({\n              label: 1,\n              skip: 1\n            });\n            pages.push({\n              label: '...',\n              disabled: true\n            });\n          }\n\n          for (; i < l; i++) {\n            pages.push({\n              label: i,\n              active: i === paging.skip,\n              skip: i\n            });\n          }if (paging.last >= l) {\n            pages.push({\n              label: '...',\n              disabled: true\n            });\n            pages.push({\n              label: paging.last,\n              skip: paging.last\n            });\n          }\n\n          if (paging.skip !== paging.last) {\n            pages.push({\n              label: '→',\n              skip: paging.skip + 1\n            });\n          }\n\n          return pages;\n        }\n      }\n    };\n  }\n})();\n'use strict';\n\n(function () {\n  'use strict';\n\n  angular.module('cn.ui').directive('cnParentWidth', cnParentWidth);\n\n  cnParentWidth.$inject = ['$window', '$timeout'];\n  function cnParentWidth($window, $timeout) {\n    return {\n      restrict: 'A',\n      link: Link\n    };\n\n    function Link(scope, elem) {\n      var w = angular.element($window);\n      var parent = elem.parent();\n\n      w.bind('resize', activate);\n      activate();\n      $timeout(activate, 250);\n\n      function activate() {\n        elem.width(parent.width());\n      }\n    }\n  }\n})();\n'use strict';\n\n(function () {\n  'use strict';\n\n  angular.module('cn.ui').directive('cnPercentageFormat', cnPercentageFormat);\n\n  function cnPercentageFormat() {\n    return {\n      require: '?ngModel',\n      link: link\n    };\n\n    function link($scope, elem, attrs, vm) {\n      if (!vm) return;\n\n      vm.$parsers.unshift(function () {\n        return _.divide(elem[0].value, 100);\n      });\n\n      vm.$formatters.unshift(function () {\n        elem[0].value = vm.$modelValue * 100;\n        return elem[0].value;\n      });\n    }\n  }\n})();\n'use strict';\n\n(function () {\n  'use strict';\n\n  angular.module('cn.ui').directive('cnProgressBar', function () {\n    return {\n      restrict: 'E',\n      replace: true,\n      scope: {\n        limit: '=cnLimit',\n        projected: '=cnProjected',\n        progress: '=cnProgress',\n        flexWidth: '=cnProgressBarFlexWidth'\n      },\n      template: '<div class=\"cn-progress-container {{flexWidth ? \\'flex-width\\' : \\'\\'}}\">\\\n                       <div class=\"cn-projected-bar\" \\\n                            ng-class=\"{\\'cn-progress-over\\': limit && projected > limit}\">\\\n                         <div class=\"cn-progress-bar\" \\\n                              ng-class=\"{\\'cn-progress-over\\': limit && progress > limit}\"></div>\\\n                       </div>\\\n                     </div>',\n      link: function link($scope, elem) {\n        var projectedBar = elem.find('.cn-projected-bar'),\n            progressBar = elem.find('.cn-progress-bar');\n\n        $scope.$watch(function () {\n          return '' + $scope.limit + $scope.projected + $scope.progress;\n        }, function () {\n          projectedBar.css('width', calculateWidth($scope.projected || $scope.progress, $scope.limit));\n          progressBar.css('width', calculateWidth($scope.progress, $scope.projected));\n        });\n\n        function calculateWidth(numerator, denominator) {\n          return (denominator ? _.percentage(numerator, denominator) : 100) + '%';\n        }\n      }\n    };\n  });\n})();\n'use strict';\n\n(function () {\n  'use strict';\n\n  angular.module('cn.ui').directive('radio', function () {\n    return {\n      restrict: 'C',\n      link: function link($scope, elem) {\n        if (elem.prop('tagName') === 'INPUT') {\n          elem.after('<span></span>');\n        } else {\n          elem.find('input[type=radio]').after('<span></span>');\n        }\n      }\n    };\n  });\n})();\n'use strict';\n\n(function () {\n  'use strict';\n\n  angular.module('cn.ui').directive('cnResponsiveHeight', cnResponsiveHeight);\n\n  cnResponsiveHeight.$inject = ['$window', '$timeout'];\n\n  function cnResponsiveHeight($window, $timeout) {\n    var directive = {\n      restrict: 'EA',\n      link: linkFunction\n    };\n\n    return directive;\n\n    function linkFunction($scope, elem, attrs) {\n      var w = angular.element($window);\n      var breakpoint = {\n        sm: 768,\n        md: 992,\n        lg: 1200\n      }[attrs.cnResponsiveBreak] || 0;\n\n      w.bind('resize', activate);\n      /* give page elements a chance to render before calculation */\n      $timeout(activate, 250);\n      $timeout(activate, 500); // twice for good measure\n\n      function activate() {\n        if ($window.innerWidth > breakpoint) {\n          var topOffset = elem.offset().top;\n          //console.log('elem:topOffset:', elem, topOffset);\n\n          if (topOffset < 0) {\n            // calculate again after any animations have completed\n            $timeout(activate, 500);\n            //$timeout(activate, 800); // twice for good measure\n          } else {\n            var bottomOffset = attrs.cnResponsiveHeight || 0;\n            var height = w.height() - topOffset - bottomOffset;\n            height = height ? height + 'px' : 'auto';\n            //console.log('attrs.cnSetMaxHeight:', attrs.cnSetMaxHeight);\n            if (_.has(attrs, 'cnSetMaxHeight')) {\n              elem.css({\n                'max-height': height,\n                'overflow': 'auto'\n              });\n            } else {\n              elem.css({\n                'height': height,\n                'overflow': 'auto'\n              });\n            }\n          }\n        } else {\n          elem.css({ 'height': '' });\n        }\n      }\n    }\n  }\n})();\n'use strict';\n\n(function () {\n  'use strict';\n\n  angular.module('cn.ui').directive('cnSelectOr', cnSelectOr);\n\n  function cnSelectOr() {\n    return {\n      restrict: 'E',\n      template: function template(elem, attrs) {\n        console.log('template:', elem, attrs);\n        var tpl = '\\\n          <div class=\"cn-select-or\" ng-disabled=\"vm.disabled\">\\\n            <p ng-show=\"vm.selectFrom.length\" class=\"toggle-view\">\\\n              <a ng-click=\"vm.toggleView()\">\\\n                {{vm.view === \\'list\\' ? vm.toggleText.list : vm.toggleText.new}}\\\n              </a>\\\n            </p>\\\n            <div ng-show=\"vm.form.view === \\'new\\'\" ng-transclude/>\\\n            <div ng-show=\"vm.form.view === \\'list\\'\" class=\"cn-list\">\\\n              <table class=\"list-group table card-flex\">\\\n                <tr ng-repeat=\"item in vm.selectFrom\"\\\n                    selection-model\\\n                    selection-model-type=\"checkbox\"\\\n                    selection-model-cleanup-strategy=\"deselect\"\\\n                    selection-model-selected-items=\"vm.selected\">\\\n                  <td class=\"col-sm-1 text-center\">\\\n                    <span class=\"checkbox\">\\\n                      <input type=\"checkbox\" id=\"checkbox{{ item.id }}\" selection-model-ignore=\"false\"/>\\\n                    </span>\\\n                  </td>\\\n                  <td class=\"col-sm-11\" ng-bind-html=\"vm.processTemplate(item)\"></td>\\\n                </tr>\\\n              </table>\\\n            </div>\\\n          </div>\\\n        ';\n        console.log('tpl:', tpl);\n        return tpl;\n      },\n      transclude: true,\n      scope: {\n        selectFrom: '=',\n        ngModel: '=',\n        form: '=ffForm',\n        directiveId: '=',\n        toggleText: '=',\n        disabled: '=',\n        itemTemplate: '='\n      },\n      require: 'ngModel',\n      link: Link,\n      controller: SelectOr,\n      controllerAs: 'vm',\n      bindToController: true\n    };\n  }\n\n  function Link($scope, elem, attrs, ctrl) {\n    var vm = $scope.vm;\n\n    $scope.$watch('vm.ngModel', validate, true);\n\n    //////////\n\n    function validate(cur, prev) {\n      if (!angular.equals(cur, prev)) {\n        ctrl.$setDirty();\n\n        if (vm.form.required) {\n          ctrl.$setValidity('tv4-302', !!cur);\n        }\n      }\n    }\n  }\n\n  SelectOr.$inject = ['$scope', '$sce', '$interpolate'];\n  function SelectOr($scope, $sce, $interpolate) {\n    var vm = this;\n    vm.selected = [];\n    vm.form.view = vm.form.view || 'new';\n    vm.activate = activate;\n    vm.onSelectionChange = onSelectionChange;\n    vm.processTemplate = processTemplate;\n    vm.setValue = setValue;\n    vm.toggleView = toggleView;\n\n    $scope.$watch('vm.selected.length', vm.onSelectionChange);\n\n    vm.activate();\n\n    ///////////\n\n    function activate() {\n      console.log('vm:', vm);\n      vm.form.schema._required = _.clone(vm.form.schema.required);\n    }\n\n    function processTemplate(item) {\n      return $sce.trustAsHtml($interpolate(vm.itemTemplate)(item));\n    }\n\n    function onSelectionChange() {\n      console.log('onSelectionChange:', vm.selected, vm.ngModel);\n      vm.setValue(_.first(vm.selected) || null);\n    }\n\n    function setValue(val) {\n      if (val) {\n        val = vm.form.schema.type === 'object' ? val : val[vm.form.valueProperty || 'value'];\n      }\n      vm.ngModel = val;\n    }\n\n    function toggleView() {\n      console.log('toggleView:', vm.form.view, vm.form);\n      vm.form.view = vm.form.view === 'new' ? 'list' : 'new';\n      if (vm.selected[0]) {\n        vm.selected[0].selected = false;\n        vm.selected.length = 0;\n      }\n    }\n  }\n})();\n'use strict';\n\n(function () {\n  'use strict';\n\n  angular.module('cn.ui').directive('cnToggleSwitch', function () {\n    return {\n      restrict: 'E',\n      replace: true,\n      template: '\\\n                  <div class=\"cn-toggle\"\\\n                       ng-class=\"currentCssState()\"\\\n                       ng-click=\"toggle($event)\">\\\n                    <i class=\"icn-toggle\"\\\n                       ng-class=\"currentCssState()\"></i>\\\n                  </div>',\n      require: '^ngModel',\n      scope: {\n        'ngModel': '=', // property used to determine on / off state\n        'onValue': '=?',\n        'offValue': '=?',\n        'undefinedClass': '=?',\n        'onChange': '&' // callback when toggle changes\n      },\n      link: function link($scope, elem, attrs, ctrl) {\n        console.log('$scope:', $scope.ngModel, ctrl);\n        $scope.onValue = _.isUndefined($scope.onValue) ? true : $scope.onValue;\n        $scope.offValue = _.isUndefined($scope.offValue) ? false : $scope.offValue;\n        $scope.undefinedClass = $scope.undefinedClass || 'schrodinger';\n\n        $scope.currentCssState = function () {\n          if ($scope.ngModel == $scope.onValue) return null;\n          if ($scope.ngModel == $scope.offValue) return 'disabled';\n          return $scope.undefinedClass;\n        };\n\n        $scope.toggle = function ($event) {\n          console.log('toggle:', $scope);\n          $event.preventDefault();\n          $event.stopImmediatePropagation();\n\n          // Using evil twins to do string to number type conversion comparison\n          if ($scope.ngModel == $scope.onValue) {\n            $scope.ngModel = $scope.offValue;\n          } else {\n            $scope.ngModel = $scope.onValue;\n          }\n\n          ctrl.$setDirty();\n\n          if ($scope.onChange) {\n            $scope.onChange();\n          }\n        };\n      }\n    };\n  });\n})();\n'use strict';\n\n(function () {\n  'use strict';\n\n  angular.module('cn.ui').directive('truncate', function () {\n    return {\n      restrict: 'AE',\n      scope: {\n        text: '=truncateText',\n        size: '=truncateSize',\n        show: '@truncateShow'\n      },\n      link: function link($scope, elem) {\n        var ogText = $scope.text || '',\n            shortText = ogText.length > $scope.size ? ogText.substr(0, $scope.size) + '…' : ogText,\n            truncated = false;\n\n        function truncate() {\n          elem.text(truncated ? ogText : shortText);\n          truncated = !truncated;\n        }\n\n        truncate();\n\n        if ($scope.show) {\n          elem.on($scope.show, truncate);\n        }\n      }\n    };\n  });\n})();\n'use strict';\n\n(function () {\n  \"use strict\";\n\n  angular.module('cn.ui').directive('xlsToJson', xlsToJsonDirective);\n\n  function xlsToJsonDirective() {\n    return {\n      restrict: 'E',\n      scope: {\n        callback: '&'\n      },\n      controller: xlsToJsonController,\n      controllerAs: 'vm',\n      bindToController: true,\n      template: '\\\n        <file-upload class=\"col-sm-6\"\\\n                     btn-text=\"Upload XLS\"\\\n                     on-file-select=\"vm.convertXLS($files)\">\\\n        </file-upload>\\\n      \\\n      '\n    };\n  }\n\n  function xlsToJsonController() {\n    var vm = this;\n\n    vm.convertXLS = convertXLS;\n\n    function convertXLS($files) {\n      var f = $files[0];\n      var reader = new FileReader();\n      var name = f.name;\n      reader.onload = function (e) {\n        var data = e.target.result;\n\n        var workbook = XLSX.read(data, { type: 'binary' });\n\n        var json = workbook.SheetNames.map(function (sheetName) {\n          return XLSX.utils.sheet_to_json(workbook.Sheets[sheetName]);\n        });\n\n        vm.callback({ jsonData: json });\n      };\n      reader.readAsBinaryString(f);\n    }\n  }\n})();","(function() {\n  'use strict';\n  angular.module('cn.ui', []);\n})();","(function() {\n  'use strict';\n\n  angular\n      .module('cn.ui')\n      .directive('checkbox', function() {\n        return {\n          restrict: 'C',\n          link: function($scope, elem) {\n            if(elem.prop('tagName') === 'INPUT') {\n              elem.after('<span></span>');\n            }\n            else {\n              elem.find('input[type=checkbox]').after('<span></span>');\n            }\n          }\n        };\n      });\n})();","(function() {\n  'use strict';\n\n  angular\n      .module('cn.ui')\n      .directive('countrySelect', function() {\n        return {\n          restrict: 'E',\n          template: '<label for=\"{{id || \\'country\\'}}\">Country</label>\\\n                     <select id=\"{{id || \\'country\\'}}\" ng-model=\"ngModel\" class=\"form-control\">\\\n                       <option value=\"US\">United States</option>\\\n                       <option value=\"AF\">Afghanistan</option>\\\n                       <option value=\"AL\">Albania</option>\\\n                       <option value=\"DZ\">Algeria</option>\\\n                       <option value=\"AS\">American Samoa</option>\\\n                       <option value=\"AD\">Andorra</option>\\\n                       <option value=\"AO\">Angola</option>\\\n                       <option value=\"AI\">Anguilla</option>\\\n                       <option value=\"AQ\">Antarctica</option>\\\n                       <option value=\"AG\">Antigua And Barbuda</option>\\\n                       <option value=\"AR\">Argentina</option>\\\n                       <option value=\"AM\">Armenia</option>\\\n                       <option value=\"AW\">Aruba</option>\\\n                       <option value=\"AU\">Australia</option>\\\n                       <option value=\"AT\">Austria</option>\\\n                       <option value=\"AZ\">Azerbaijan</option>\\\n                       <option value=\"BS\">Bahamas</option>\\\n                       <option value=\"BH\">Bahrain</option>\\\n                       <option value=\"BD\">Bangladesh</option>\\\n                       <option value=\"BB\">Barbados</option>\\\n                       <option value=\"BY\">Belarus</option>\\\n                       <option value=\"BE\">Belgium</option>\\\n                       <option value=\"BZ\">Belize</option>\\\n                       <option value=\"BJ\">Benin</option>\\\n                       <option value=\"BM\">Bermuda</option>\\\n                       <option value=\"BT\">Bhutan</option>\\\n                       <option value=\"BO\">Bolivia</option>\\\n                       <option value=\"BA\">Bosnia And Herzegovina</option>\\\n                       <option value=\"BW\">Botswana</option>\\\n                       <option value=\"BV\">Bouvet Island</option>\\\n                       <option value=\"BR\">Brazil</option>\\\n                       <option value=\"IO\">British Indian Ocean Territory</option>\\\n                       <option value=\"BN\">Brunei Darussalam</option>\\\n                       <option value=\"BG\">Bulgaria</option>\\\n                       <option value=\"BF\">Burkina Faso</option>\\\n                       <option value=\"BI\">Burundi</option>\\\n                       <option value=\"KH\">Cambodia</option>\\\n                       <option value=\"CM\">Cameroon</option>\\\n                       <option value=\"CA\">Canada</option>\\\n                       <option value=\"CV\">Cape Verde</option>\\\n                       <option value=\"KY\">Cayman Islands</option>\\\n                       <option value=\"CF\">Central African Republic</option>\\\n                       <option value=\"TD\">Chad</option>\\\n                       <option value=\"CL\">Chile</option>\\\n                       <option value=\"CN\">China</option>\\\n                       <option value=\"CX\">Christmas Island</option>\\\n                       <option value=\"CC\">Cocos (keeling) Islands</option>\\\n                       <option value=\"CO\">Colombia</option>\\\n                       <option value=\"KM\">Comoros</option>\\\n                       <option value=\"CG\">Congo</option>\\\n                       <option value=\"CK\">Cook Islands</option>\\\n                       <option value=\"CR\">Costa Rica</option>\\\n                       <option value=\"CI\">Cote D Ivoire</option>\\\n                       <option value=\"HR\">Croatia</option>\\\n                       <option value=\"CU\">Cuba</option>\\\n                       <option value=\"CY\">Cyprus</option>\\\n                       <option value=\"CZ\">Czech Republic</option>\\\n                       <option value=\"DK\">Denmark</option>\\\n                       <option value=\"DJ\">Djibouti</option>\\\n                       <option value=\"DM\">Dominica</option>\\\n                       <option value=\"DO\">Dominican Republic</option>\\\n                       <option value=\"TP\">East Timor</option>\\\n                       <option value=\"EC\">Ecuador</option>\\\n                       <option value=\"EG\">Egypt</option>\\\n                       <option value=\"SV\">El Salvador</option>\\\n                       <option value=\"GQ\">Equatorial Guinea</option>\\\n                       <option value=\"ER\">Eritrea</option>\\\n                       <option value=\"EE\">Estonia</option>\\\n                       <option value=\"ET\">Ethiopia</option>\\\n                       <option value=\"FK\">Falkland Islands (malvinas)</option>\\\n                       <option value=\"FO\">Faroe Islands</option>\\\n                       <option value=\"FJ\">Fiji</option>\\\n                       <option value=\"FI\">Finland</option>\\\n                       <option value=\"FR\">France</option>\\\n                       <option value=\"GF\">French Guiana</option>\\\n                       <option value=\"PF\">French Polynesia</option>\\\n                       <option value=\"TF\">French Southern Territories</option>\\\n                       <option value=\"GA\">Gabon</option>\\\n                       <option value=\"GM\">Gambia</option>\\\n                       <option value=\"GE\">Georgia</option>\\\n                       <option value=\"DE\">Germany</option>\\\n                       <option value=\"GH\">Ghana</option>\\\n                       <option value=\"GI\">Gibraltar</option>\\\n                       <option value=\"GR\">Greece</option>\\\n                       <option value=\"GL\">Greenland</option>\\\n                       <option value=\"GD\">Grenada</option>\\\n                       <option value=\"GP\">Guadeloupe</option>\\\n                       <option value=\"GU\">Guam</option>\\\n                       <option value=\"GT\">Guatemala</option>\\\n                       <option value=\"GN\">Guinea</option>\\\n                       <option value=\"GW\">Guinea-bissau</option>\\\n                       <option value=\"GY\">Guyana</option>\\\n                       <option value=\"HT\">Haiti</option>\\\n                       <option value=\"VA\">Holy See (vatican City State)</option>\\\n                       <option value=\"HN\">Honduras</option>\\\n                       <option value=\"HK\">Hong Kong</option>\\\n                       <option value=\"HU\">Hungary</option>\\\n                       <option value=\"IS\">Iceland</option>\\\n                       <option value=\"IN\">India</option>\\\n                       <option value=\"ID\">Indonesia</option>\\\n                       <option value=\"IR\">Iran, Islamic Republic Of</option>\\\n                       <option value=\"IQ\">Iraq</option>\\\n                       <option value=\"IE\">Ireland</option>\\\n                       <option value=\"IL\">Israel</option>\\\n                       <option value=\"IT\">Italy</option>\\\n                       <option value=\"JM\">Jamaica</option>\\\n                       <option value=\"JP\">Japan</option>\\\n                       <option value=\"JO\">Jordan</option>\\\n                       <option value=\"KZ\">Kazakstan</option>\\\n                       <option value=\"KE\">Kenya</option>\\\n                       <option value=\"KI\">Kiribati</option>\\\n                       <option value=\"KP\">Korea Democratic Peoples Republic Of</option>\\\n                       <option value=\"KR\">Korea Republic Of</option>\\\n                       <option value=\"KW\">Kuwait</option>\\\n                       <option value=\"KG\">Kyrgyzstan</option>\\\n                       <option value=\"LA\">Lao Peoples Democratic Republic</option>\\\n                       <option value=\"LV\">Latvia</option>\\\n                       <option value=\"LB\">Lebanon</option>\\\n                       <option value=\"LS\">Lesotho</option>\\\n                       <option value=\"LR\">Liberia</option>\\\n                       <option value=\"LY\">Libyan Arab Jamahiriya</option>\\\n                       <option value=\"LI\">Liechtenstein</option>\\\n                       <option value=\"LT\">Lithuania</option>\\\n                       <option value=\"LU\">Luxembourg</option>\\\n                       <option value=\"MO\">Macau</option>\\\n                       <option value=\"MK\">Macedonia</option>\\\n                       <option value=\"MG\">Madagascar</option>\\\n                       <option value=\"MW\">Malawi</option>\\\n                       <option value=\"MY\">Malaysia</option>\\\n                       <option value=\"MV\">Maldives</option>\\\n                       <option value=\"ML\">Mali</option>\\\n                       <option value=\"MT\">Malta</option>\\\n                       <option value=\"MH\">Marshall Islands</option>\\\n                       <option value=\"MQ\">Martinique</option>\\\n                       <option value=\"MR\">Mauritania</option>\\\n                       <option value=\"MU\">Mauritius</option>\\\n                       <option value=\"YT\">Mayotte</option>\\\n                       <option value=\"MX\">Mexico</option>\\\n                       <option value=\"FM\">Micronesia, Federated States Of</option>\\\n                       <option value=\"MD\">Moldova, Republic Of</option>\\\n                       <option value=\"MC\">Monaco</option>\\\n                       <option value=\"MN\">Mongolia</option>\\\n                       <option value=\"MS\">Montserrat</option>\\\n                       <option value=\"MA\">Morocco</option>\\\n                       <option value=\"MZ\">Mozambique</option>\\\n                       <option value=\"MM\">Myanmar</option>\\\n                       <option value=\"NA\">Namibia</option>\\\n                       <option value=\"NR\">Nauru</option>\\\n                       <option value=\"NP\">Nepal</option>\\\n                       <option value=\"NL\">Netherlands</option>\\\n                       <option value=\"AN\">Netherlands Antilles</option>\\\n                       <option value=\"NC\">New Caledonia</option>\\\n                       <option value=\"NZ\">New Zealand</option>\\\n                       <option value=\"NI\">Nicaragua</option>\\\n                       <option value=\"NE\">Niger</option>\\\n                       <option value=\"NG\">Nigeria</option>\\\n                       <option value=\"NU\">Niue</option>\\\n                       <option value=\"NF\">Norfolk Island</option>\\\n                       <option value=\"MP\">Northern Mariana Islands</option>\\\n                       <option value=\"NO\">Norway</option>\\\n                       <option value=\"OM\">Oman</option>\\\n                       <option value=\"PK\">Pakistan</option>\\\n                       <option value=\"PW\">Palau</option>\\\n                       <option value=\"PS\">Palestinian Territory, Occupied</option>\\\n                       <option value=\"PA\">Panama</option>\\\n                       <option value=\"PG\">Papua New Guinea</option>\\\n                       <option value=\"PY\">Paraguay</option>\\\n                       <option value=\"PE\">Peru</option>\\\n                       <option value=\"PH\">Philippines</option>\\\n                       <option value=\"PN\">Pitcairn</option>\\\n                       <option value=\"PL\">Poland</option>\\\n                       <option value=\"PT\">Portugal</option>\\\n                       <option value=\"PR\">Puerto Rico</option>\\\n                       <option value=\"QA\">Qatar</option>\\\n                       <option value=\"RE\">Reunion</option>\\\n                       <option value=\"RO\">Romania</option>\\\n                       <option value=\"RU\">Russian Federation</option>\\\n                       <option value=\"RW\">Rwanda</option>\\\n                       <option value=\"SH\">Saint Helena</option>\\\n                       <option value=\"KN\">Saint Kitts And Nevis</option>\\\n                       <option value=\"LC\">Saint Lucia</option>\\\n                       <option value=\"PM\">Saint Pierre And Miquelon</option>\\\n                       <option value=\"VC\">Saint Vincent And The Grenadines</option>\\\n                       <option value=\"WS\">Samoa</option>\\\n                       <option value=\"SM\">San Marino</option>\\\n                       <option value=\"ST\">Sao Tome And Principe</option>\\\n                       <option value=\"SA\">Saudi Arabia</option>\\\n                       <option value=\"SN\">Senegal</option>\\\n                       <option value=\"SC\">Seychelles</option>\\\n                       <option value=\"SL\">Sierra Leone</option>\\\n                       <option value=\"SG\">Singapore</option>\\\n                       <option value=\"SK\">Slovakia</option>\\\n                       <option value=\"SI\">Slovenia</option>\\\n                       <option value=\"SB\">Solomon Islands</option>\\\n                       <option value=\"SO\">Somalia</option>\\\n                       <option value=\"ZA\">South Africa</option>\\\n                       <option value=\"GS\">South Georgia</option>\\\n                       <option value=\"ES\">Spain</option>\\\n                       <option value=\"LK\">Sri Lanka</option>\\\n                       <option value=\"SD\">Sudan</option>\\\n                       <option value=\"SR\">Suriname</option>\\\n                       <option value=\"SJ\">Svalbard And Jan Mayen</option>\\\n                       <option value=\"SZ\">Swaziland</option>\\\n                       <option value=\"SE\">Sweden</option>\\\n                       <option value=\"CH\">Switzerland</option>\\\n                       <option value=\"SY\">Syrian Arab Republic</option>\\\n                       <option value=\"TW\">Taiwan, Province Of China</option>\\\n                       <option value=\"TJ\">Tajikistan</option>\\\n                       <option value=\"TZ\">Tanzania, United Republic Of</option>\\\n                       <option value=\"TH\">Thailand</option>\\\n                       <option value=\"TG\">Togo</option>\\\n                       <option value=\"TK\">Tokelau</option>\\\n                       <option value=\"TO\">Tonga</option>\\\n                       <option value=\"TT\">Trinidad And Tobago</option>\\\n                       <option value=\"TN\">Tunisia</option>\\\n                       <option value=\"TR\">Turkey</option>\\\n                       <option value=\"TM\">Turkmenistan</option>\\\n                       <option value=\"TC\">Turks And Caicos Islands</option>\\\n                       <option value=\"TV\">Tuvalu</option>\\\n                       <option value=\"UG\">Uganda</option>\\\n                       <option value=\"UA\">Ukraine</option>\\\n                       <option value=\"AE\">United Arab Emirates</option>\\\n                       <option value=\"GB\">United Kingdom</option>\\\n                       <option value=\"UM\">United States Minor Outlying Islands</option>\\\n                       <option value=\"UY\">Uruguay</option>\\\n                       <option value=\"UZ\">Uzbekistan</option>\\\n                       <option value=\"VU\">Vanuatu</option>\\\n                       <option value=\"VE\">Venezuela</option>\\\n                       <option value=\"VN\">Viet Nam</option>\\\n                       <option value=\"VG\">Virgin Islands, British</option>\\\n                       <option value=\"VI\">Virgin Islands, U.s.</option>\\\n                       <option value=\"WF\">Wallis And Futuna</option>\\\n                       <option value=\"EH\">Western Sahara</option>\\\n                       <option value=\"YE\">Yemen</option>\\\n                       <option value=\"YU\">Yugoslavia</option>\\\n                       <option value=\"ZM\">Zambia</option>\\\n                       <option value=\"ZW\">Zimbabwe</option>\\\n                     </select>',\n          scope: {\n            id: '&?',\n            ngModel: '='\n          }\n        };\n      });\n})();","(function() {\n  \"use strict\";\n\n  angular\n      .module('cn.ui')\n      .directive('csvUpload', csvUpload);\n\n  function csvUpload() {\n    return {\n      restrict: 'E',\n      scope: {\n        cnUploadPath: '=',\n        ngModel: '=',\n      },\n      link: Link,\n      controller: Upload,\n      controllerAs: 'vm',\n      bindToController: true,\n      template: '\\\n        <file-upload class=\"col-sm-6\"\\\n                     btn-text=\"Upload CSV\"\\\n                     on-file-select=\"vm.uploadFile($files)\">\\\n        </file-upload>\\\n      '\n    };\n  }\n\n  function Link($scope, elem, attrs, ctrl) {\n    $scope.$watch('vm.ngModel', function(newVal, prevVal) {\n        if($scope.onChange) {\n          $scope.onChange({$value: newVal});\n        }\n        $scope.$parent.$parent.ngModel.$setValidity('schemaForm', true);\n        $scope.$parent.$parent.ngModel.$setValidity('tv4-302', !_.isEmpty($scope.vm.ngModel));\n        if(!angular.equals(newVal, prevVal)) {\n          $scope.$parent.$parent.ngModel.$setDirty();\n        }\n      });\n  }\n\n  Upload.$inject = ['$q', '$http', '$sce', 'cfpLoadingBar'];\n  function Upload($q, $http, $sce, cfpLoadingBar) {\n    var vm = this;\n\n    vm.uploadFile = uploadFile;\n\n    function uploadFile($files) {\n      var dfr = $q.defer();\n      dfr.promise.then(setModelValue, cfpLoadingBar.complete);\n\n      var formData = new FormData();\n      formData.append('csv', $files[0]);\n\n      $.ajax({\n        url: vm.cnUploadPath,\n        headers: $http.defaults.headers.common,\n        data: formData,\n        processData: false,\n        contentType: false,\n        type: 'POST',\n        success: dfr.resolve,\n        error: dfr.reject\n      });\n\n      cfpLoadingBar.start();\n    }\n\n    function setModelValue(response) {\n      cfpLoadingBar.complete();\n      vm.ngModel = response;\n    }\n  }\n})();","(function() {\n  'use strict';\n\n  angular.module('cn.ui')\n      .directive('cnCurrencyFormat', cnCurrencyFormat);\n\n  cnCurrencyFormat.$inject = ['$compile'];\n  function cnCurrencyFormat($compile) {\n    return {\n      require: '?ngModel',\n      link: link\n    };\n\n    function link($scope, elem, attrs, vm) {\n      if(!vm) return;\n\n      var format = attrs.cnCurrencyFormat;\n      var placeholder = attrs.cnCurrencyPlaceholder;\n\n      activate();\n\n      //////////\n\n      function activate() {\n        if(placeholder) {\n          placeholder = formatVal(placeholder);\n          elem.attr('placeholder', placeholder);\n        }\n\n        elem.on('blur', function(el) {\n          if(/\\.\\d$/.test(elem[0].value)) return elem[0].value += '0';\n\n          var overflow = elem[0].value.match(/(\\d*\\.\\d{2})(.+)/);\n          if(overflow) elem[0].value = overflow[1];\n        });\n\n        vm.$parsers.unshift(parseVal);\n        vm.$formatters.unshift(function(val) {\n          //console.log('val:', val);\n          vm.$setDirty();\n          return formatVal(val);\n        });\n      }\n\n\n      function parseVal(val) {\n        if(!val) return 0;\n        if(format === 'cents') {\n          return _.multiply(val, 100);\n        }\n        if(format === 'microcents') {\n          return _.multiply(val, 1000000);\n        }\n        return parseFloat(val);\n      }\n\n      function formatVal(val) {\n        if(!val) val = '';\n        else if(format === 'cents') {\n          val = _.floor(val / 100, 2) || '';\n        }\n        else if(format === 'microcents') {\n          val = _.floor(val / 1000000, 2) || '';\n        }\n        else {\n          val = _.floor(val, 2) || '';\n        }\n        return /\\.\\d$/.test(val) ? val + '0' : val;\n      }\n    }\n  }\n\n})();","(function() {\n  'use strict';\n\n  angular\n      .module('cn.ui')\n      .directive('fileUpload', function() {\n        return {\n          restrict: 'E',\n          replace: true,\n          scope: {\n            btnStyle: '@',\n            iconStyle: '@',\n            callback: '&onFileSelect',\n            inputId: '@',\n            btnText: '@'\n          },\n          template: '<div class=\"file-wrapper\">\\\n                       <button class=\"btn btn-file {{btnStyle}}\">\\\n                         <i ng-if=\"iconStyle\" class=\"{{iconStyle}}\"></i> {{btnText}}\\\n                       </button>\\\n                       <input type=\"file\" id=\"{{inputId}}\" class=\"form-control\" \\\n                              ng-file-select=\"onFileSelect($files)\"/>\\\n                     </div>',\n          compile: function(elem, attrs) {\n            attrs.btnStyle = /btn-(primary|success|info|warning|danger|link)/.test(attrs.btnStyle) ?\n                attrs.btnStyle : attrs.btnStyle + ' btn-default';\n            attrs.inputId = attrs.inputId || ('file-' + _.uniqueId());\n            attrs.btnText = attrs.btnText || 'Choose a file...';\n\n            return function link($scope, elem) {\n              var btn = elem.find('button'),\n                  file = elem.find('input');\n\n              btn.click(function() {\n                file.click();\n              });\n\n              $scope.onFileSelect = function($files) {\n                $scope.callback({$files: $files});\n              };\n            };\n          }\n        };\n      });\n})();","(function() {\n  'use strict';\n\n  angular\n      .module('cn.ui')\n      .directive('cnIframeHeight', cnIframeHeight);\n\n  cnIframeHeight.$inject = ['$timeout'];\n  function cnIframeHeight($timeout) {\n    return {\n      restrict: 'A',\n      link: Link\n    };\n\n    function Link($scope, elem, attrs) {\n      var body, $body, h;\n      var insurance;\n\n      $scope.$watch(function(){ return attrs.ngSrc; }, function() {\n        if(attrs.ngSrc) {\n          insurance = 0;\n          $timeout(activate, 100);\n        }\n      });\n\n      ////////\n\n      function activate() {\n        body = getBody();\n        if(body) {\n          elem.height('');\n          h = body.scrollHeight;\n          elem.height(h);\n          angular.element(body).find('img').on('load', activate);\n          if(!insurance) {\n            ++insurance;\n            $timeout(activate, 200);\n            $timeout(activate, 500);\n            $timeout(activate, 1000);\n            $timeout(activate, 1500);\n            $timeout(activate, 3500);\n            $timeout(activate, 5000);\n            $timeout(activate, 7500);\n            $timeout(activate, 10000);\n          }\n          return;\n        }\n        $timeout(activate, 100);\n      }\n\n      function getBody() {\n        return elem.get(0).contentDocument && elem.get(0).contentDocument.body;\n      }\n    }\n  }\n})();","(function() {\n  'use strict';\n\n  angular\n      .module('cn.ui')\n      .directive('linkToFacebook', function() {\n\n        var base = 'https://www.facebook.com/ads/manage/summary/';\n\n        return {\n          restrict: 'E',\n          replace: true,\n          template: '<a href=\"{{ link }}\" target=\"_blank\" ng-show=\"link\" ng-click=\"$event.stopPropagation();\">\\\n                       {{text}}\\\n                       <span class=\"glyphicon glyphicon-new-window small\"></span>\\\n                     </a>',\n          scope: {\n            'fbObject': '=',\n            'text': '@?'\n          },\n\n          link: function($scope) {\n            if($scope.fbObject.twitterLink) {\n              $scope.link = $scope.fbObject.twitterLink;\n            }\n            else if(_.has($scope.fbObject, 'fbCampaignGroupId')) {\n              if($scope.fbObject.fbCampaignGroupId) {\n                $scope.link = base + 'campaign/?campaign_id=' + $scope.fbObject.fbCampaignGroupId;\n              }\n            } else if(_.has($scope.fbObject, 'fbCampaignId')) {\n              if($scope.fbObject.fbCampaignId) {\n                $scope.link = base + 'adset/?ad_set_id=' + $scope.fbObject.fbCampaignId;\n              }\n            } else if(_.has($scope.fbObject, 'fbAdgroupId')) {\n              if($scope.fbObject.adSet.fbCampaignId && $scope.fbObject.fbAdgroupId) {\n                $scope.link = base + 'adset/?ad_set_id=' + $scope.fbObject.adSet.fbCampaignId + '&show_adgroup_id=' + $scope.fbObject.fbAdgroupId;\n              }\n            }\n          }\n        };\n      });\n})();","(function() {\n  'use strict';\n\n  angular\n      .module('cn.ui')\n      .directive('cnLoadingBar', function() {\n        return {\n          restrict: 'E',\n          replace: true,\n          scope: {\n            run: '='\n          },\n          template: '<div><cn-progress-bar cn-limit=\"1\" cn-progress=\"progress\"></cn-progress-bar></div>',\n          controller: ['$scope', '$interval', function($scope, $interval) {\n            $scope.progress = 0;\n            $scope.counter = 1;\n            $scope.numerator = 1;\n            $scope.denominator = 3;\n\n            $scope.$watch('run', function(newVal, oldVal) {\n              console.log('run:', $scope.run);\n              if(newVal === oldVal) return;\n              if($scope.run) {\n                start();\n              }\n              else {\n                stop();\n              }\n            });\n\n            function start() {\n              $scope.interval = $interval(function() {\n                $scope.progress = $scope.progress + ($scope.numerator / $scope.denominator);\n                $scope.denominator = $scope.denominator + (2 / $scope.counter);\n                $scope.counter = $scope.counter * 0.66;\n              }, 500);\n            }\n\n            function stop() {\n              console.log('stop:', $scope.interval);\n              $interval.cancel($scope.interval);\n              $scope.progress = 100;\n            }\n\n            $scope.$on('$destroy', function() {\n              stop();\n            });\n          }]\n        };\n      });\n})();","(function() {\n  \"use strict\";\n\n  angular\n      .module('cn.ui')\n      .directive('mediaUpload', mediaUpload);\n\n  function mediaUpload() {\n    return {\n      restrict: 'E',\n      scope: {\n        cnUploadPath: '=',\n        cnFileType: '=',\n        cnPreviewPath: '=',\n        cnModelValueKey: '=',\n        ngModel: '=',\n        cnData: '='\n      },\n      controller: Upload,\n      controllerAs: 'vm',\n      bindToController: true,\n      template: '\\\n        <div class=\"img-placeholder col-sm-6\" ng-class=\"{ empty: !vm.filePath }\">\\\n          <img ng-if=\"vm.cnFileType === \\'image\\'\" ng-src=\"{{vm.filePath}}\"/>\\\n          <video ng-if=\"vm.cnFileType === \\'video\\' && vm.filePath\"\\\n                 ng-src=\"{{vm.filePath}}\"\\\n                 controls=\"controls\"/>\\\n        </div>\\\n        <file-upload class=\"col-sm-6\"\\\n                     btn-text=\"Upload {{vm.cnFileType | titleCase}}\"\\\n                     on-file-select=\"vm.uploadFile($files)\">\\\n        </file-upload>\\\n      '\n    };\n  }\n\n  Upload.$inject = ['$q', '$http', '$sce', 'cfpLoadingBar'];\n  function Upload($q, $http, $sce, cfpLoadingBar) {\n    var vm = this;\n\n    vm.uploadFile = uploadFile;\n\n    function uploadFile($files) {\n      var dfr = $q.defer();\n      dfr.promise.then(setFilePath, cfpLoadingBar.complete);\n\n      var formData = new FormData();\n      formData.append(vm.cnFileType, $files[0]);\n\n      _.each(vm.cnData, function(value, key) {\n        if(value) formData.append(key, value);\n      });\n\n      $.ajax({\n        url: vm.cnUploadPath,\n        headers: $http.defaults.headers.common,\n        data: formData,\n        processData: false,\n        contentType: false,\n        type: 'POST',\n        success: dfr.resolve,\n        error: dfr.reject\n      });\n\n      cfpLoadingBar.start();\n    }\n\n    function setFilePath(response) {\n      cfpLoadingBar.complete();\n      vm.ngModel = response[vm.cnModelValueKey || 'media_id_string'];\n      vm.filePath = $sce.trustAsResourceUrl(response[vm.cnPreviewPath || 'cn_preview_url']);\n    }\n  }\n})();","(function() {\n  'use strict';\n\n  angular\n      .module('cn.ui')\n      .factory('cnModal', cnModal);\n\n  cnModal.$inject = ['$modal', '$rootScope'];\n  function cnModal($modal, $rootScope) {\n    var vm = {\n      onChangeState: null,\n      open\n    };\n\n    return vm;\n\n    ////////\n\n    function open(options) {\n      vm.onChangeState = $rootScope.$on('$stateChangeStart', () => {\n        console.log('changeState:', vm.modal);\n        vm.onChangeState();\n        if(vm.modal) {\n          vm.modal.close();\n        }\n      });\n      vm.modal = $modal.open(options);\n      return vm.modal;\n    }\n  }\n\n})();","(function() {\n  'use strict';\n\n  angular.module('cn.ui')\n      .directive('cnPagination', cnPagination);\n\n  function cnPagination() {\n    return {\n      restrict: 'E',\n      replace: true,\n      template: '\\\n          <div class=\"cn-pagination clearfix\"><div ng-if=\"paging\">\\\n            <div class=\"btn-group\" ng-if=\"count\">\\\n              <button type=\"button\" \\\n                      class=\"btn btn-sm btn-primary dropdown-toggle\" \\\n                      data-toggle=\"dropdown\">\\\n                {{count}} Results <span class=\"caret\"></span>\\\n              </button>\\\n              <ul class=\"dropdown-menu\" role=\"menu\">\\\n                <li><a ng-click=\"onClick(1, 10)\">10 Results</a></li>\\\n                <li><a ng-click=\"onClick(1, 25)\">25 Results</a></li>\\\n                <li><a ng-click=\"onClick(1, 50)\">50 Results</a></li>\\\n              </ul>\\\n            </div>\\\n            <ul class=\"pagination\" ng-if=\"pages.length > 1\">\\\n              <li ng-repeat=\"page in pages\"\\\n                  ng-class=\"{active: page.active}\">\\\n                <a ng-if=\"!page.disabled\"\\\n                   ng-click=\"page.skip && onClick(page.skip)\">{{page.label}}</a>\\\n                <span ng-if=\"page.disabled\">{{page.label}}</span>\\\n              </li>\\\n            </ul>\\\n          </div></div>',\n      scope: {\n        paging: '=',\n        onClick: '=',\n        count: '=?'\n      },\n      link: function($scope) {\n\n        $scope.$watch('paging', function() {\n          if($scope.paging) {\n            $scope.pages = buildPaging($scope.paging);\n          }\n        });\n\n        function buildPaging(paging) {\n          var pages = [],\n              i = paging.skip < 4 ?\n                  1 : (paging.skip > paging.last - 3 ? paging.last - 4 : paging.skip - 2),\n              l = paging.last + 1 > i + 5 ? i + 5 : paging.last + 1;\n\n          if(paging.skip !== 1) {\n            pages.push({\n              label: '\\u2190',\n              skip: paging.skip - 1\n            });\n          }\n\n          if(1 < i) {\n            pages.push({\n              label: 1,\n              skip: 1\n            });\n            pages.push({\n              label: '...',\n              disabled: true\n            });\n          }\n\n          for(; i < l; i++) pages.push({\n            label: i,\n            active: i === paging.skip,\n            skip: i\n          });\n\n          if(paging.last >= l) {\n            pages.push({\n              label: '...',\n              disabled: true\n            });\n            pages.push({\n              label: paging.last,\n              skip: paging.last\n            });\n          }\n\n          if(paging.skip !== paging.last) {\n            pages.push({\n              label: '\\u2192',\n              skip: paging.skip + 1\n            });\n          }\n\n          return pages;\n        }\n      }\n    };\n  }\n\n})();","(function() {\n  'use strict';\n\n  angular\n    .module('cn.ui')\n    .directive('cnParentWidth', cnParentWidth);\n\n  cnParentWidth.$inject = ['$window', '$timeout'];\n  function cnParentWidth($window, $timeout) {\n    return {\n      restrict: 'A',\n      link: Link\n    };\n\n    function Link(scope, elem) {\n      var w = angular.element($window);\n      var parent = elem.parent();\n\n      w.bind('resize', activate);\n      activate();\n      $timeout(activate, 250);\n\n      function activate() {\n        elem.width(parent.width());\n      }\n    }\n  }\n})();","(function() {\n  'use strict';\n\n  angular.module('cn.ui')\n      .directive('cnPercentageFormat', cnPercentageFormat);\n\n  function cnPercentageFormat() {\n    return {\n      require: '?ngModel',\n      link: link\n    };\n\n    function link($scope, elem, attrs, vm) {\n      if(!vm) return;\n\n      vm.$parsers.unshift(function() {\n        return _.divide(elem[0].value, 100);\n      });\n\n      vm.$formatters.unshift(function() {\n        elem[0].value = vm.$modelValue * 100;\n        return elem[0].value;\n      });\n    }\n  }\n\n})();","(function() {\n  'use strict';\n\n  angular\n      .module('cn.ui')\n      .directive('cnProgressBar', function() {\n        return {\n          restrict: 'E',\n          replace: true,\n          scope: {\n            limit: '=cnLimit',\n            projected: '=cnProjected',\n            progress: '=cnProgress',\n            flexWidth: '=cnProgressBarFlexWidth'\n          },\n          template: '<div class=\"cn-progress-container {{flexWidth ? \\'flex-width\\' : \\'\\'}}\">\\\n                       <div class=\"cn-projected-bar\" \\\n                            ng-class=\"{\\'cn-progress-over\\': limit && projected > limit}\">\\\n                         <div class=\"cn-progress-bar\" \\\n                              ng-class=\"{\\'cn-progress-over\\': limit && progress > limit}\"></div>\\\n                       </div>\\\n                     </div>',\n          link: function($scope, elem) {\n            var projectedBar = elem.find('.cn-projected-bar'),\n                progressBar = elem.find('.cn-progress-bar');\n\n            $scope.$watch(function() {\n              return '' + $scope.limit + $scope.projected + $scope.progress;\n            }, function() {\n              projectedBar.css('width', calculateWidth($scope.projected || $scope.progress, $scope.limit));\n              progressBar.css('width', calculateWidth($scope.progress, $scope.projected));\n            });\n\n            function calculateWidth(numerator, denominator) {\n              return (denominator ? _.percentage(numerator, denominator) : 100) + '%';\n            }\n          }\n        };\n      });\n})();","(function() {\n  'use strict';\n\n  angular\n      .module('cn.ui')\n      .directive('radio', function() {\n        return {\n          restrict: 'C',\n          link: function($scope, elem) {\n            if(elem.prop('tagName') === 'INPUT') {\n              elem.after('<span></span>');\n            }\n            else {\n              elem.find('input[type=radio]').after('<span></span>');\n            }\n          }\n        };\n      });\n})();","(function() {\n  'use strict';\n\n  angular\n      .module('cn.ui')\n      .directive('cnResponsiveHeight', cnResponsiveHeight);\n\n  cnResponsiveHeight.$inject = ['$window', '$timeout'];\n\n  function cnResponsiveHeight($window, $timeout) {\n    var directive = {\n      restrict: 'EA',\n      link: linkFunction\n    };\n\n    return directive;\n\n    function linkFunction($scope, elem, attrs) {\n      var w = angular.element($window);\n      var breakpoint = {\n            sm: 768,\n            md: 992,\n            lg: 1200\n          }[attrs.cnResponsiveBreak] || 0;\n\n      w.bind('resize', activate);\n      /* give page elements a chance to render before calculation */\n      $timeout(activate, 250);\n      $timeout(activate, 500); // twice for good measure\n\n      function activate() {\n        if($window.innerWidth > breakpoint) {\n          var topOffset = elem.offset().top;\n          //console.log('elem:topOffset:', elem, topOffset);\n\n          if(topOffset < 0) {\n            // calculate again after any animations have completed\n            $timeout(activate, 500);\n            //$timeout(activate, 800); // twice for good measure\n          }\n          else {\n            var bottomOffset = attrs.cnResponsiveHeight || 0;\n            var height = w.height() - topOffset - bottomOffset;\n            height = height ? height + 'px' : 'auto';\n            //console.log('attrs.cnSetMaxHeight:', attrs.cnSetMaxHeight);\n            if (_.has(attrs, 'cnSetMaxHeight')) {\n              elem.css({\n              'max-height': height,\n              'overflow': 'auto'\n            });\n            } else {\n              elem.css({\n              'height': height,\n              'overflow': 'auto'\n            });\n            }\n\n          }\n        }\n        else {\n          elem.css({ 'height': '' });\n        }\n      }\n    }\n  }\n})();","(function() {\n  'use strict';\n  angular\n      .module('cn.ui')\n      .directive('cnSelectOr', cnSelectOr);\n\n  function cnSelectOr() {\n    return {\n      restrict: 'E',\n      template: function(elem, attrs) {\n        console.log('template:', elem, attrs);\n        var tpl = '\\\n          <div class=\"cn-select-or\" ng-disabled=\"vm.disabled\">\\\n            <p ng-show=\"vm.selectFrom.length\" class=\"toggle-view\">\\\n              <a ng-click=\"vm.toggleView()\">\\\n                {{vm.view === \\'list\\' ? vm.toggleText.list : vm.toggleText.new}}\\\n              </a>\\\n            </p>\\\n            <div ng-show=\"vm.form.view === \\'new\\'\" ng-transclude/>\\\n            <div ng-show=\"vm.form.view === \\'list\\'\" class=\"cn-list\">\\\n              <table class=\"list-group table card-flex\">\\\n                <tr ng-repeat=\"item in vm.selectFrom\"\\\n                    selection-model\\\n                    selection-model-type=\"checkbox\"\\\n                    selection-model-cleanup-strategy=\"deselect\"\\\n                    selection-model-selected-items=\"vm.selected\">\\\n                  <td class=\"col-sm-1 text-center\">\\\n                    <span class=\"checkbox\">\\\n                      <input type=\"checkbox\" id=\"checkbox{{ item.id }}\" selection-model-ignore=\"false\"/>\\\n                    </span>\\\n                  </td>\\\n                  <td class=\"col-sm-11\" ng-bind-html=\"vm.processTemplate(item)\"></td>\\\n                </tr>\\\n              </table>\\\n            </div>\\\n          </div>\\\n        ';\n        console.log('tpl:', tpl);\n        return tpl;\n      },\n      transclude: true,\n      scope: {\n        selectFrom: '=',\n        ngModel: '=',\n        form: '=ffForm',\n        directiveId: '=',\n        toggleText: '=',\n        disabled: '=',\n        itemTemplate: '='\n      },\n      require: 'ngModel',\n      link: Link,\n      controller: SelectOr,\n      controllerAs: 'vm',\n      bindToController: true\n    };\n  }\n\n  function Link($scope, elem, attrs, ctrl) {\n    var vm = $scope.vm;\n\n    $scope.$watch('vm.ngModel', validate, true);\n\n    //////////\n\n    function validate(cur, prev) {\n      if(!angular.equals(cur, prev)) {\n        ctrl.$setDirty();\n\n        if(vm.form.required) {\n          ctrl.$setValidity('tv4-302', !!(cur));\n        }\n      }\n    }\n  }\n\n  SelectOr.$inject = ['$scope', '$sce', '$interpolate'];\n  function SelectOr($scope, $sce, $interpolate) {\n    var vm = this;\n    vm.selected = [];\n    vm.form.view = vm.form.view || 'new';\n    vm.activate = activate;\n    vm.onSelectionChange = onSelectionChange;\n    vm.processTemplate = processTemplate;\n    vm.setValue = setValue;\n    vm.toggleView = toggleView;\n\n    $scope.$watch('vm.selected.length', vm.onSelectionChange);\n\n    vm.activate();\n\n    ///////////\n\n    function activate() {\n      console.log('vm:', vm);\n      vm.form.schema._required = _.clone(vm.form.schema.required);\n    }\n\n    function processTemplate(item) {\n      return $sce.trustAsHtml($interpolate(vm.itemTemplate)(item));\n    }\n\n    function onSelectionChange() {\n      console.log('onSelectionChange:', vm.selected, vm.ngModel);\n      vm.setValue(_.first(vm.selected) || null);\n    }\n\n    function setValue(val) {\n      if(val) {\n        val = vm.form.schema.type === 'object' ? val : val[vm.form.valueProperty || 'value'];\n      }\n      vm.ngModel = val;\n    }\n\n    function toggleView() {\n      console.log('toggleView:', vm.form.view, vm.form);\n      vm.form.view = vm.form.view === 'new' ? 'list' : 'new';\n      if(vm.selected[0]) {\n        vm.selected[0].selected = false;\n        vm.selected.length = 0;\n      }\n    }\n\n  }\n\n})();","(function() {\n  'use strict';\n\n  angular\n      .module('cn.ui')\n      .directive('cnToggleSwitch', function() {\n        return {\n          restrict: 'E',\n          replace: true,\n          template: '\\\n                  <div class=\"cn-toggle\"\\\n                       ng-class=\"currentCssState()\"\\\n                       ng-click=\"toggle($event)\">\\\n                    <i class=\"icn-toggle\"\\\n                       ng-class=\"currentCssState()\"></i>\\\n                  </div>',\n          require: '^ngModel',\n          scope: {\n            'ngModel': '=',     // property used to determine on / off state\n            'onValue': '=?',\n            'offValue': '=?',\n            'undefinedClass': '=?',\n            'onChange': '&'     // callback when toggle changes\n          },\n          link: function($scope, elem, attrs, ctrl) {\n            console.log('$scope:', $scope.ngModel, ctrl);\n            $scope.onValue = _.isUndefined($scope.onValue) ? true : $scope.onValue;\n            $scope.offValue = _.isUndefined($scope.offValue) ? false : $scope.offValue;\n            $scope.undefinedClass = $scope.undefinedClass || 'schrodinger';\n\n            $scope.currentCssState = function() {\n              if($scope.ngModel == $scope.onValue) return null;\n              if($scope.ngModel == $scope.offValue) return 'disabled';\n              return $scope.undefinedClass;\n            };\n\n            $scope.toggle = function($event) {\n              console.log('toggle:', $scope);\n              $event.preventDefault();\n              $event.stopImmediatePropagation();\n\n              // Using evil twins to do string to number type conversion comparison\n              if($scope.ngModel == $scope.onValue) {\n                $scope.ngModel = $scope.offValue;\n              }\n              else {\n                $scope.ngModel = $scope.onValue;\n              }\n\n              ctrl.$setDirty();\n\n              if($scope.onChange) {\n                $scope.onChange();\n              }\n            };\n          }\n        };\n      });\n})();","(function() {\n  'use strict';\n\n  angular\n      .module('cn.ui')\n      .directive('truncate', function() {\n        return {\n          restrict: 'AE',\n          scope: {\n            text: '=truncateText',\n            size: '=truncateSize',\n            show: '@truncateShow'\n          },\n          link: function($scope, elem) {\n            var ogText = $scope.text || '',\n                shortText = ogText.length > $scope.size ?\n                  ogText.substr(0, $scope.size) + '\\u2026' : ogText,\n                truncated = false;\n\n            function truncate() {\n              elem.text(truncated ? ogText : shortText);\n              truncated = !truncated;\n            }\n\n            truncate();\n\n            if($scope.show) {\n              elem.on($scope.show, truncate);\n            }\n          }\n        };\n      });\n})();","(function() {\n  \"use strict\";\n\n  angular\n      .module('cn.ui')\n      .directive('xlsToJson', xlsToJsonDirective);\n\n  function xlsToJsonDirective() {\n    return {\n      restrict: 'E',\n      scope: {\n        callback: '&'\n      },\n      controller: xlsToJsonController,\n      controllerAs: 'vm',\n      bindToController: true,\n      template: '\\\n        <file-upload class=\"col-sm-6\"\\\n                     btn-text=\"Upload XLS\"\\\n                     on-file-select=\"vm.convertXLS($files)\">\\\n        </file-upload>\\\n      \\\n      '\n    };\n  }\n\n  function xlsToJsonController() {\n    let vm = this;\n\n    vm.convertXLS = convertXLS;\n\n    function convertXLS($files) {\n      var f = $files[0];\n      var reader = new FileReader();\n      var name = f.name;\n      reader.onload = function(e) {\n        var data = e.target.result;\n\n        var workbook = XLSX.read(data, {type: 'binary'});\n\n        var json = workbook.SheetNames.map(sheetName =>\n            XLSX.utils.sheet_to_json(workbook.Sheets[sheetName])\n        );\n\n        vm.callback({jsonData: json});\n      };\n      reader.readAsBinaryString(f);\n    }\n  }\n})();"]}